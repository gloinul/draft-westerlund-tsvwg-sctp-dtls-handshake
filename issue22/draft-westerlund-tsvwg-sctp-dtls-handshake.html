<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Datagram Transport Layer Security (DTLS) based key-management of the Stream Control Transmission Protocol (SCTP) DTLS Chunk</title>
<meta content="Magnus Westerlund" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Claudio Porfiri" name="author">
<meta content="
       This document defines a key-management solution based on Datagram
Transport Layer Security 1.3 (DTLS) to protect the content of Stream
Control Transmission Protocol (SCTP) packets using the packet
protection framework provided by the SCTP DTLS chunk. The combination
provides encryption, source authentication, integrity and replay
protection for the SCTP association with in-band DTLS based
key-management and mutual authentication of the peers. The
specification is enabling very long-lived sessions of weeks and months
and supports mutual re-authentication and rekeying with ephemeral key
exchange. The key-management solution does not require any additional
defined features or implementation support beyond core DTLS 1.3. This
is intended as a replacement to using DTLS/SCTP (RFC6083) and
SCTP-AUTH (RFC4895). 
    " name="description">
<meta content="xml2rfc 3.30.2" name="generator">
<meta content="draft-westerlund-tsvwg-sctp-dtls-handshake-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.2
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.4.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-westerlund-tsvwg-sctp-dtls-handshake.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTLS in SCTP</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Westerlund, et al.</td>
<td class="center">Expires 3 April 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TSVWG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-westerlund-tsvwg-sctp-dtls-handshake-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-30" class="published">30 September 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-04-03">3 April 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Westerlund</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">C. Porfiri</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Datagram Transport Layer Security (DTLS) based key-management of the Stream Control Transmission Protocol (SCTP) DTLS Chunk</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a key-management solution based on Datagram
Transport Layer Security 1.3 (DTLS) to protect the content of Stream
Control Transmission Protocol (SCTP) packets using the packet
protection framework provided by the SCTP DTLS chunk. The combination
provides encryption, source authentication, integrity and replay
protection for the SCTP association with in-band DTLS based
key-management and mutual authentication of the peers. The
specification is enabling very long-lived sessions of weeks and months
and supports mutual re-authentication and rekeying with ephemeral key
exchange. The key-management solution does not require any additional
defined features or implementation support beyond core DTLS 1.3. This
is intended as a replacement to using DTLS/SCTP (RFC6083) and
SCTP-AUTH (RFC4895).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-westerlund-tsvwg-sctp-dtls-handshake/">https://datatracker.ietf.org/doc/draft-westerlund-tsvwg-sctp-dtls-handshake/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Area Working Group (tsvwg) Working Group mailing list (<span><a href="mailto:tsvwg@ietf.org">mailto:tsvwg@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tsvwg/">https://mailarchive.ietf.org/arch/browse/tsvwg/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tsvwg/">https://www.ietf.org/mailman/listinfo/tsvwg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/gloinul/draft-westerlund-tsvwg-sctp-dtls-handshake">https://github.com/gloinul/draft-westerlund-tsvwg-sctp-dtls-handshake</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 April 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-properties-of-dtls-in-sctp" class="internal xref">Properties of DTLS in SCTP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-abbreviations" class="internal xref">Abbreviations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-conventions" class="internal xref">Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-dtls-usage-of-dtls-chunk" class="internal xref">DTLS usage of DTLS Chunk</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dtls-messages-over-sctp-use" class="internal xref">DTLS messages over SCTP User Messages</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protection-valid-message" class="internal xref">Protection Valid Message</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-dtls-chunk-integration" class="internal xref">DTLS Chunk Integration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-sctp-association-life-cycle" class="internal xref">SCTP Association Life Cycle.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-protection-initialization" class="internal xref">Protection Initialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-sctp-association-ongoing" class="internal xref">SCTP Association Ongoing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-shutdown-states" class="internal xref">SHUTDOWN states</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-dtls-connection-handling" class="internal xref">DTLS Connection Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-add-a-new-dtls-connection" class="internal xref">Add a New DTLS Connection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-remove-an-existing-dtls-con" class="internal xref">Remove an existing DTLS Connection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-considerations-about-remova" class="internal xref">Considerations about removal of DTLS Connections</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-dtls-key-update" class="internal xref">DTLS Key Update</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-error-cases" class="internal xref">Error Cases</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-dtls-considerations" class="internal xref">DTLS Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-version-of-dtls" class="internal xref">Version of DTLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-configuration-of-key-manage" class="internal xref">Configuration of Key-Management DTLS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-general" class="internal xref">General</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-authentication-and-policy-d" class="internal xref">Authentication and Policy Decisions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-new-connections" class="internal xref">New Connections</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="auto internal xref">6.2.4</a>.  <a href="#name-dtls-13" class="internal xref">DTLS 1.3</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-establishing-dtls-in-sctp" class="internal xref">Establishing DTLS in SCTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-dtls-key-context-derivation" class="internal xref">DTLS Key Context derivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-dtls-handshake" class="internal xref">DTLS Handshake</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-protection-initilization-us" class="internal xref">Protection Initilization using DTLS connection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-handshake-of-further-dtls-c" class="internal xref">Handshake of further DTLS connections</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-sctp-association-restart" class="internal xref">SCTP Association Restart</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-installation-of-initial-res" class="internal xref">Installation of initial Restart DTLS Key Context</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-installation-of-restart-dtl" class="internal xref">Installation of Restart DTLS Key Context for further DTLS Connections</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="auto internal xref">7.3.3</a>.  <a href="#name-sctp-association-restart-pr" class="internal xref">SCTP Association Restart Procedure</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-parallel-dtls-rekeying" class="internal xref">Parallel DTLS Rekeying</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-criteria-for-rekeying" class="internal xref">Criteria for Rekeying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-procedure-for-rekeying" class="internal xref">Procedure for Rekeying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-race-condition-in-rekeying" class="internal xref">Race Condition in Rekeying</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-general-2" class="internal xref">General</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-consideration" class="internal xref">IANA Consideration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-sctp-protection-solution-id" class="internal xref">SCTP Protection Solution Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-tls-exporter-labels" class="internal xref">TLS Exporter Labels</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="overview">
<section id="section-1.1">
        <h3 id="name-overview">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.1-1">This document describes the usage of the Datagram Transport Layer
   Security version 1.3 (DTLS) <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> protocol for key-management
   of the SCTP DTLS Chunk packet protection
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span> securing Stream Control
   Transmission Protocol (SCTP) <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>.  This combination of
   specifications is intended as a replacement to DTLS/SCTP
   <span>[<a href="#RFC6083" class="cite xref">RFC6083</a>]</span> and usage of SCTP-AUTH <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>. The combination of
   SCTP DTLS Chunk and the key-management defined in this document we
   refer to as DTLS in SCTP.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">DTLS in SCTP provides mutual authentication of endpoints, data
   confidentiality, data origin authentication, data integrity
   protection, and data replay protection of SCTP packets. Ensuring
   these security services to the application and its upper layer
   protocol over SCTP.  Thus, it allows client/server applications to
   communicate in a way that is designed with communications privacy
   and preventing eavesdropping and detect tampering or message
   forgery.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Applications using DTLS in SCTP can use all currently existing
   transport features provided by SCTP and its extensions, in some
   cases with some limitations, as specified in
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>. DTLS in SCTP supports:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">
            <p id="section-1.1-4.1.1">preservation of message boundaries.<a href="#section-1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">no limitation on number of unidirectional and bidirectional streams.<a href="#section-1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.3">
            <p id="section-1.1-4.3.1">ordered and unordered delivery of SCTP user messages.<a href="#section-1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.4">
            <p id="section-1.1-4.4.1">the partial reliability extension as defined in <span>[<a href="#RFC3758" class="cite xref">RFC3758</a>]</span>.<a href="#section-1.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.5">
            <p id="section-1.1-4.5.1">multi-homing of the SCTP association per <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>.<a href="#section-1.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.6">
            <p id="section-1.1-4.6.1">the dynamic address reconfiguration extension as defined in
 <span>[<a href="#RFC5061" class="cite xref">RFC5061</a>]</span> (Limitations apply).<a href="#section-1.1-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.7">
            <p id="section-1.1-4.7.1">User messages of any size.<a href="#section-1.1-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.8">
            <p id="section-1.1-4.8.1">SCTP Packets with a protected set of chunks up to a size of
2<sup>14</sup> (16384) bytes.<a href="#section-1.1-4.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-5">The main benefit of this key-management solution over the solution
   proposed by the WG is that this does not require any extensions to
   DTLS 1.3 to be implemented. It solely relies on the core DTLS
   handshake to do mutual authentication, creates a main secret, and
   then relies on the TLS exporter to export necessary secrets for the
   DTLS Chunk.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol_overview">
<section id="section-1.2">
        <h3 id="name-protocol-overview">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
        </h3>
<p id="section-1.2-1">DTLS in SCTP is a key management specification for the SCTP DTLS
   1.3 chunk <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span> that together
   utilizes DTLS 1.3 for the security functions like key
   exchange, authentication, encryption, integrity protection, and
   replay protection. All key management message exchange happens
   inband over the SCTP assocation.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">In this document we use the terms DTLS Key context for indicating
   the pair of keys, derived from a DTLS connection, and all relevant
   data that needs to be provided to the SCTP DTLS Chunk Protection
   Operator for DTLS encryption and decryption.  DTLS Key context
   includes Keys for sending and receiving, replay window, and last used
   sequence number. Each DTLS key context is associated with a four
   value tuple identifying the context, consisting of SCTP
   Association, the restart indicator, the DTLS Connection ID (if
   used), and the DTLS epoch.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">The basic functionalities and how things are related is described
   below:<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-4.1">
            <p id="section-1.2-4.1.1">The process starts with a SCTP association where DTLS 1.3 Chunk
   usage has been negotiated and this key-management method has been
   agreed in the SCTP INIT and INIT-ACK. To initialize and authenticate
   the peer the DTLS handshake is exchanged as SCTP user messages with
   the DTLS Chunk Key-Management Messages PPID (see section 10.6 of
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>) until an initial DTLS
   connection has been established.  If the DTLS handshake fails, the
   SCTP association is aborted. With successful handshake and
   authentication of the peer the key material is exported from the DTLS
   connection and configured for the DTLS 1.3 chunk. From that point
   until SCTP association termination the DTLS chunk will protect the
   SCTP packets. When the DTLS connection has been established and the
   DTLS Chunk configured with DTLS Key context the PVALID message is
   sent to trigger the peer SCTP Endpoint that Protection initiation
   has been completed.<a href="#section-1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-4.2">
            <p id="section-1.2-4.2.1">After PVALID is received, the Upper Layer Protocol(ULP) can
   start sending messages over the SCTP association. All chunks are
   protected by encapsulating them in DTLS chunks as defined in
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>.  Using the current DTLS
   Key context the DTLS Chunk Protection operator protects the plain
   text, which is all chunks to be sent in one SCTP packet, producing
   a DTLS Record that is encapsulated in the DTLS chunk and then
   transmitted as a SCTP packet with a common header.<a href="#section-1.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-5">The DTLS Chunk specifies that in the receiving SCTP endpoint each
   incoming SCTP packet on any of its interfaces and ports are matched
   to the SCTP association based on ports and VTAG in the common
   header. Using the indicated DTLS Key context(s) for that SCTP
   association the content of the DTLS chunk is attempted to be
   processed, including replay protection, decryption, and integrity
   checking. If decryption and integrity verification was
   successful the produced plain text of one or more SCTP chunks are
   provided for normal SCTP processing in the identified SCTP
   association along with associated per-packet meta data such as path
   received on, original packet size, and ECN bits.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">When mutual re-authentication or rekeying is needed or desired by
   either endpoint a new DTLS connection handshake is performed
   between the SCTP endpoints and new DTLS Key contexts are
   created. When the handshake is completed, the DTLS in SCTP
   implementation can simply switch to use the new DTLS Key contexts
   in the DTLS chunk.  All rekeying SHALL be using ephemeral key
   exchange and SHALL NOT use the DTLS Key-Update mechanism to avoid
   confusion about the properties of the DTLS Key Contexts for the
   DTLS chunk.  After a short while (no longer than 2 min) to enable
   any outstanding packets to drain from the network path between the
   endpoints, the old key-management DTLS connection is closed and
   that signal that the corresponding key context can be deleted from
   the DTLS chunk's key store.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<p id="section-1.2-7">The DTLS connection may send alerts, handshake messages, or
   other non-application data to its peer at any point in time.
   All DTLS message will be sent by means of SCTP user messages
   with the DTLS Chunk Key-Management Messages PPID as specified in
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>. However, only the
   DTLS close_notify is expected to be used after the handshake has
   been completed in this solution.<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<span id="name-dtls-in-sctp-layer-in-regar"></span><div id="overview-layering">
<figure id="figure-1">
          <div id="section-1.2-8.1">
            <div class="alignLeft art-svg artwork" id="section-1.2-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="656" width="440" viewBox="0 0 440 656" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,464" fill="none" stroke="black"></path>
                <path d="M 8,560 L 8,640" fill="none" stroke="black"></path>
                <path d="M 72,472 L 72,512" fill="none" stroke="black"></path>
                <path d="M 96,512 L 96,552" fill="none" stroke="black"></path>
                <path d="M 136,32 L 136,464" fill="none" stroke="black"></path>
                <path d="M 152,32 L 152,464" fill="none" stroke="black"></path>
                <path d="M 168,80 L 168,416" fill="none" stroke="black"></path>
                <path d="M 176,576 L 176,624" fill="none" stroke="black"></path>
                <path d="M 192,64 L 192,96" fill="none" stroke="black"></path>
                <path d="M 192,128 L 192,160" fill="none" stroke="black"></path>
                <path d="M 192,400 L 192,448" fill="none" stroke="black"></path>
                <path d="M 216,176 L 216,336" fill="none" stroke="black"></path>
                <path d="M 232,336 L 232,368" fill="none" stroke="black"></path>
                <path d="M 248,176 L 248,336" fill="none" stroke="black"></path>
                <path d="M 264,176 L 264,336" fill="none" stroke="black"></path>
                <path d="M 280,336 L 280,400" fill="none" stroke="black"></path>
                <path d="M 288,472 L 288,512" fill="none" stroke="black"></path>
                <path d="M 296,176 L 296,336" fill="none" stroke="black"></path>
                <path d="M 352,576 L 352,624" fill="none" stroke="black"></path>
                <path d="M 368,64 L 368,96" fill="none" stroke="black"></path>
                <path d="M 368,128 L 368,160" fill="none" stroke="black"></path>
                <path d="M 368,400 L 368,448" fill="none" stroke="black"></path>
                <path d="M 392,80 L 392,592" fill="none" stroke="black"></path>
                <path d="M 408,32 L 408,464" fill="none" stroke="black"></path>
                <path d="M 408,560 L 408,640" fill="none" stroke="black"></path>
                <path d="M 8,32 L 136,32" fill="none" stroke="black"></path>
                <path d="M 152,32 L 408,32" fill="none" stroke="black"></path>
                <path d="M 192,64 L 368,64" fill="none" stroke="black"></path>
                <path d="M 168,80 L 184,80" fill="none" stroke="black"></path>
                <path d="M 368,80 L 392,80" fill="none" stroke="black"></path>
                <path d="M 192,96 L 368,96" fill="none" stroke="black"></path>
                <path d="M 192,128 L 368,128" fill="none" stroke="black"></path>
                <path d="M 168,144 L 192,144" fill="none" stroke="black"></path>
                <path d="M 192,160 L 368,160" fill="none" stroke="black"></path>
                <path d="M 216,176 L 248,176" fill="none" stroke="black"></path>
                <path d="M 264,176 L 296,176" fill="none" stroke="black"></path>
                <path d="M 216,336 L 248,336" fill="none" stroke="black"></path>
                <path d="M 264,336 L 296,336" fill="none" stroke="black"></path>
                <path d="M 232,368 L 312,368" fill="none" stroke="black"></path>
                <path d="M 192,400 L 368,400" fill="none" stroke="black"></path>
                <path d="M 168,416 L 184,416" fill="none" stroke="black"></path>
                <path d="M 192,448 L 368,448" fill="none" stroke="black"></path>
                <path d="M 8,464 L 136,464" fill="none" stroke="black"></path>
                <path d="M 152,464 L 408,464" fill="none" stroke="black"></path>
                <path d="M 72,512 L 288,512" fill="none" stroke="black"></path>
                <path d="M 8,560 L 408,560" fill="none" stroke="black"></path>
                <path d="M 176,576 L 352,576" fill="none" stroke="black"></path>
                <path d="M 360,592 L 392,592" fill="none" stroke="black"></path>
                <path d="M 176,624 L 352,624" fill="none" stroke="black"></path>
                <path d="M 8,640 L 408,640" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="400,552 388,546.4 388,557.6" fill="black" transform="rotate(90,392,552)"></polygon>
                <polygon class="arrowhead" points="368,592 356,586.4 356,597.6" fill="black" transform="rotate(180,360,592)"></polygon>
                <polygon class="arrowhead" points="296,472 284,466.4 284,477.6" fill="black" transform="rotate(270,288,472)"></polygon>
                <polygon class="arrowhead" points="192,416 180,410.4 180,421.6" fill="black" transform="rotate(0,184,416)"></polygon>
                <polygon class="arrowhead" points="192,80 180,74.4 180,85.6" fill="black" transform="rotate(0,184,80)"></polygon>
                <polygon class="arrowhead" points="104,552 92,546.4 92,557.6" fill="black" transform="rotate(90,96,552)"></polygon>
                <polygon class="arrowhead" points="80,472 68,466.4 68,477.6" fill="black" transform="rotate(270,72,472)"></polygon>
                <g class="text">
                  <text x="72" y="52">ULP</text>
                  <text x="268" y="52">DTLS</text>
                  <text x="304" y="52">1.3</text>
                  <text x="240" y="84">Key</text>
                  <text x="292" y="84">Exporter</text>
                  <text x="240" y="148">Key</text>
                  <text x="300" y="148">Management</text>
                  <text x="232" y="196">H</text>
                  <text x="232" y="212">a</text>
                  <text x="184" y="228">k</text>
                  <text x="232" y="228">n</text>
                  <text x="280" y="228">A</text>
                  <text x="376" y="228">k</text>
                  <text x="184" y="244">e</text>
                  <text x="232" y="244">d</text>
                  <text x="280" y="244">l</text>
                  <text x="376" y="244">e</text>
                  <text x="184" y="260">y</text>
                  <text x="232" y="260">s</text>
                  <text x="280" y="260">e</text>
                  <text x="344" y="260">...</text>
                  <text x="376" y="260">y</text>
                  <text x="184" y="276">s</text>
                  <text x="232" y="276">h</text>
                  <text x="280" y="276">r</text>
                  <text x="376" y="276">s</text>
                  <text x="232" y="292">a</text>
                  <text x="280" y="292">t</text>
                  <text x="232" y="308">k</text>
                  <text x="232" y="324">e</text>
                  <text x="324" y="372">..</text>
                  <text x="224" y="388">ContentType</text>
                  <text x="284" y="420">Record</text>
                  <text x="244" y="436">Protection</text>
                  <text x="324" y="436">Operator</text>
                  <text x="420" y="516">keys</text>
                  <text x="68" y="532">PPID</text>
                  <text x="92" y="596">SCTP</text>
                  <text x="272" y="596">Chunk</text>
                  <text x="228" y="612">Protection</text>
                  <text x="308" y="612">Operator</text>
                </g>
              </svg><a href="#section-1.2-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-dtls-in-sctp-layer-in-regar" class="selfRef">DTLS in SCTP layer in regard to SCTP and upper layer protocol</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="properties-of-dtls-in-sctp">
<section id="section-1.3">
        <h3 id="name-properties-of-dtls-in-sctp">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-properties-of-dtls-in-sctp" class="section-name selfRef">Properties of DTLS in SCTP</a>
        </h3>
<p id="section-1.3-1">DTLS in SCTP (as the combination of the DTLS chunk and the in-band
   authentication and key-management using DTLS handshakes defined in
   this document) has a number of properties that are attractive.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">
            <p id="section-1.3-2.1.1">Provides confidentiality, integrity protection, and source
authentication for each SCTP packet.<a href="#section-1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.2">
            <p id="section-1.3-2.2.1">Provides replay protection on SCTP packet level preventing
malicious replay attacks on SCTP, both protecting the data as well
as the SCTP functions themselves.<a href="#section-1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.3">
            <p id="section-1.3-2.3.1">Provides mutual authentication of the endpoints based on any
authentication mechanism supported by DTLS.<a href="#section-1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.4">
            <p id="section-1.3-2.4.1">Uses parallel DTLS connections to enable mutual re-authentication
and rekeying with ephemeral key-exchange. Thus, enabling SCTP
association lifetimes without known limitations and without
needing to drain the SCTP association.<a href="#section-1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.5">
            <p id="section-1.3-2.5.1">Uses core of DTLS as it is and updates and fixes to DTLS security
properties; can be implemented without further changes to this
specification.<a href="#section-1.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.6">
            <p id="section-1.3-2.6.1">No reliance on DTLS implementation used for key-management having
to support any features beyond core DTLS specification and the
TLS exporter.<a href="#section-1.3-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.7">
            <p id="section-1.3-2.7.1">Secures all SCTP packets exchanged after SCTP association has
reached the established state and the initial key-exchange has
completed. Making targeted attacks against the SCTP protocol and
implementation much harder.<a href="#section-1.3-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.8">
            <p id="section-1.3-2.8.1">DTLS in SCTP results in no limitations on user message
transmission or message sizes, those properties are the same as
for an unprotected SCTP association.<a href="#section-1.3-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.9">
            <p id="section-1.3-2.9.1">Limited overhead on a per packet basis, with 4 bytes for the
DTLS chunk plus the DTLS record overhead. The DTLS
overhead is dependent on the DTLS version and cipher suit.<a href="#section-1.3-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.10">
            <p id="section-1.3-2.10.1">Support of SCTP packet plain text payload sizes up to
2<sup>14</sup> bytes.<a href="#section-1.3-2.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="terminology">
<section id="section-1.4">
        <h3 id="name-terminology">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.4-1">This document uses the following terms:<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.4-2">
          <dt id="section-1.4-2.1">Association:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.2">
            <p id="section-1.4-2.2.1">An SCTP association.<a href="#section-1.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.3">Connection:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.4">
            <p id="section-1.4-2.4.1">A DTLS connection.<a href="#section-1.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.5">DTLS Key context:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.6">
            <p id="section-1.4-2.6.1">Keys, derived from a DTLS connection, and all relevant data that needs
   to be provided to the SCTP DTLS Chunk.
   Each DTLS key context is associated with a four value
   tuple identifying the context, consisting of SCTP Association, the
   restart indicator, the DTLS Connection ID (if used), and the DTLS
   epoch<a href="#section-1.4-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.7">Primary DTLS Key context:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.8">
            <p id="section-1.4-2.8.1">A DTLS Key context used to
    protect the regular SCTP traffic, i.e. not a restart DTLS Key context.<a href="#section-1.4-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.9">Restart DTLS Key context:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.10">
            <p id="section-1.4-2.10.1">A DTLS Key context to be
used for an SCTP Association Restart<a href="#section-1.4-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.11">Stream:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.12">
            <p id="section-1.4-2.12.1">A unidirectional stream of an SCTP association.  It is
   uniquely identified by a stream identifier.<a href="#section-1.4-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.13">Traffic:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.14">
            <p id="section-1.4-2.14.1">The stream of DATA and Control chunks being sent on any stream between
  SCTP Endpoints in the scope of an Association<a href="#section-1.4-2.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="abbreviations">
<section id="section-1.5">
        <h3 id="name-abbreviations">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-1.5-1">
          <dt id="section-1.5-1.1">AEAD:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.2">
            <p id="section-1.5-1.2.1">Authenticated Encryption with Associated Data<a href="#section-1.5-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.3">DKC:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.4">
            <p id="section-1.5-1.4.1">DTLS Key Context<a href="#section-1.5-1.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.5">DTLS:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.6">
            <p id="section-1.5-1.6.1">Datagram Transport Layer Security<a href="#section-1.5-1.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.7">MTU:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.8">
            <p id="section-1.5-1.8.1">Maximum Transmission Unit<a href="#section-1.5-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.9">PPID:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.10">
            <p id="section-1.5-1.10.1">Payload Protocol Identifier<a href="#section-1.5-1.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.11">SCTP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.12">
            <p id="section-1.5-1.12.1">Stream Control Transmission Protocol<a href="#section-1.5-1.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.13">ULP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.14">
            <p id="section-1.5-1.14.1">Upper Layer Protocol<a href="#section-1.5-1.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="conventions">
<section id="section-1.6">
        <h3 id="name-conventions">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
        </h3>
<p id="section-1.6-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-usage-of-dtls-chunk">
<section id="section-2">
      <h2 id="name-dtls-usage-of-dtls-chunk">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-dtls-usage-of-dtls-chunk" class="section-name selfRef">DTLS usage of DTLS Chunk</a>
      </h2>
<p id="section-2-1">DTLS in SCTP uses the DTLS chunk as specified in
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>. The chunk if just
   repeated here for the reader's convenience.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span id="name-dtls-chunk-structure"></span><div id="sctp-dtls-chunk-structure">
<figure id="figure-2">
        <div id="section-2-2.1">
          <div class="alignLeft art-svg artwork" id="section-2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="208" width="528" viewBox="0 0 528 208" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,64 L 8,192" fill="none" stroke="black"></path>
              <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
              <path d="M 248,64 L 248,96" fill="none" stroke="black"></path>
              <path d="M 264,64 L 264,96" fill="none" stroke="black"></path>
              <path d="M 264,160 L 264,192" fill="none" stroke="black"></path>
              <path d="M 520,64 L 520,192" fill="none" stroke="black"></path>
              <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
              <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
              <path d="M 264,160 L 520,160" fill="none" stroke="black"></path>
              <path d="M 8,192 L 520,192" fill="none" stroke="black"></path>
              <g class="text">
                <text x="16" y="36">0</text>
                <text x="176" y="36">1</text>
                <text x="336" y="36">2</text>
                <text x="496" y="36">3</text>
                <text x="16" y="52">0</text>
                <text x="32" y="52">1</text>
                <text x="48" y="52">2</text>
                <text x="64" y="52">3</text>
                <text x="80" y="52">4</text>
                <text x="96" y="52">5</text>
                <text x="112" y="52">6</text>
                <text x="128" y="52">7</text>
                <text x="144" y="52">8</text>
                <text x="160" y="52">9</text>
                <text x="176" y="52">0</text>
                <text x="192" y="52">1</text>
                <text x="208" y="52">2</text>
                <text x="224" y="52">3</text>
                <text x="240" y="52">4</text>
                <text x="256" y="52">5</text>
                <text x="272" y="52">6</text>
                <text x="288" y="52">7</text>
                <text x="304" y="52">8</text>
                <text x="320" y="52">9</text>
                <text x="336" y="52">0</text>
                <text x="352" y="52">1</text>
                <text x="368" y="52">2</text>
                <text x="384" y="52">3</text>
                <text x="400" y="52">4</text>
                <text x="416" y="52">5</text>
                <text x="432" y="52">6</text>
                <text x="448" y="52">7</text>
                <text x="464" y="52">8</text>
                <text x="480" y="52">9</text>
                <text x="496" y="52">0</text>
                <text x="512" y="52">1</text>
                <text x="36" y="84">Type</text>
                <text x="64" y="84">=</text>
                <text x="92" y="84">0x4x</text>
                <text x="172" y="84">reserved</text>
                <text x="256" y="84">R</text>
                <text x="360" y="84">Chunk</text>
                <text x="412" y="84">Length</text>
                <text x="264" y="132">Payload</text>
                <text x="384" y="180">Padding</text>
              </g>
            </svg><a href="#section-2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-dtls-chunk-structure" class="selfRef">DTLS Chunk Structure</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Type: 8 bits</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          <p id="section-2-3.2.1">The Chunk Type indicate that this is the DTLS chunk.<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">reserved: 7 bits</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
          <p id="section-2-3.4.1">Reserved bits for future use. Sender MUST set these bits to 0 and
MUST be ignored on reception.<a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">R: 1 bit (boolean)</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
          <p id="section-2-3.6.1">Restart indicator. If this bit is set this DTLS chunk is protected
with by a Restart DTLS Key context.<a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">Chunk Length: 16 bits (unsigned integer)</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">
          <p id="section-2-3.8.1">This value holds the length of the Payload in bytes plus 4.<a href="#section-2-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Payload: variable length</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">
          <p id="section-2-3.10.1">This holds the encrypted data as one DTLS 1.3 Record <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>.<a href="#section-2-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">Padding: 0, 8, 16, or 24 bits</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.12">
          <p id="section-2-3.12.1">To ensure the Chunk is whole 32-bit words long.<a href="#section-2-3.12.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="dtls-user-message">
<section id="section-3">
      <h2 id="name-dtls-messages-over-sctp-use">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dtls-messages-over-sctp-use" class="section-name selfRef">DTLS messages over SCTP User Messages</a>
      </h2>
<p id="section-3-1">When DTLS in SCTP has completed the initialization, that is after
PVALID message has been sent for triggering,
DTLS messages for the Handshake DTLS connection, i.e. that are not
DTLS records containing protected SCTP chunk payloads, will be sent as
SCTP user messages using the format defined in <a href="#sctp-dtls-user-message" class="auto internal xref">Figure 3</a>.
A DTLS handshake
message may be fragmented by DTLS to a set of DTLS records of a
maximum configured fragment size. Each DTLS message fragment is sent
as a SCTP user message on the same stream where each message is
configured for reliable and in-order delivery with the PPID set to
DTLS Chunk Key-Management Messages
<span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>. These user messages MAY
contain one or more DTLS records. The SCTP stream ID used MAY be any
stream ID that the ULP already uses, and if not known Stream 0. Note
that all fragments of a handshake message MUST be sent with the same
stream ID to ensure the in-order delivery.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The DTLS instance SHOULD NOT use DTLS retransmission to repair any
packet losses of handshake message fragment.
If the DTLS
implementation supports configuring a MTU larger than the actual IP
MTU it MAY be used as SCTP provides reliability and fragmentation.<a href="#section-3-2" class="pilcrow">¶</a></p>
<span id="name-dtls-user-message-structure"></span><div id="sctp-dtls-user-message">
<figure id="figure-3">
        <div id="section-3-3.1">
          <div class="alignLeft art-svg artwork" id="section-3-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="208" width="528" viewBox="0 0 528 208" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,64 L 8,192" fill="none" stroke="black"></path>
              <path d="M 104,64 L 104,96" fill="none" stroke="black"></path>
              <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
              <path d="M 264,160 L 264,192" fill="none" stroke="black"></path>
              <path d="M 520,64 L 520,160" fill="none" stroke="black"></path>
              <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
              <path d="M 8,96 L 136,96" fill="none" stroke="black"></path>
              <path d="M 264,160 L 520,160" fill="none" stroke="black"></path>
              <path d="M 8,192 L 264,192" fill="none" stroke="black"></path>
              <g class="text">
                <text x="16" y="36">0</text>
                <text x="176" y="36">1</text>
                <text x="336" y="36">2</text>
                <text x="496" y="36">3</text>
                <text x="16" y="52">0</text>
                <text x="32" y="52">1</text>
                <text x="48" y="52">2</text>
                <text x="64" y="52">3</text>
                <text x="80" y="52">4</text>
                <text x="96" y="52">5</text>
                <text x="112" y="52">6</text>
                <text x="128" y="52">7</text>
                <text x="144" y="52">8</text>
                <text x="160" y="52">9</text>
                <text x="176" y="52">0</text>
                <text x="192" y="52">1</text>
                <text x="208" y="52">2</text>
                <text x="224" y="52">3</text>
                <text x="240" y="52">4</text>
                <text x="256" y="52">5</text>
                <text x="272" y="52">6</text>
                <text x="288" y="52">7</text>
                <text x="304" y="52">8</text>
                <text x="320" y="52">9</text>
                <text x="336" y="52">0</text>
                <text x="352" y="52">1</text>
                <text x="368" y="52">2</text>
                <text x="384" y="52">3</text>
                <text x="400" y="52">4</text>
                <text x="416" y="52">5</text>
                <text x="432" y="52">6</text>
                <text x="448" y="52">7</text>
                <text x="464" y="52">8</text>
                <text x="480" y="52">9</text>
                <text x="496" y="52">0</text>
                <text x="512" y="52">1</text>
                <text x="52" y="84">Reserved</text>
                <text x="120" y="84">DCI</text>
                <text x="252" y="132">DTLS</text>
                <text x="304" y="132">Message</text>
              </g>
            </svg><a href="#section-3-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-dtls-user-message-structure" class="selfRef">DTLS User Message Structure</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3-4">
        <dt id="section-3-4.1">Reserved: 6 bits</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.2">
          <p id="section-3-4.2.1">Each bit MUST be set to zero (0) on transmission and MUST
be ignored on reception. These bits MAY in the future be assigned
a meaning when set to one (1).<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.3">DCI: DTLS Connection Index 2 bits (unsigned integer)</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.4">
          <p id="section-3-4.4.1">DTLS Connection Index is the lower two bits of an DTLS Connection
Index counter which corresponds to the epoch used in the SCTP DTLS
Chunk.  This is a counter implemented in DTLS in SCTP that is used
to identify which DTLS connection instance that is capable of
processing the DTLS message over a user message.  This index is
recommended to be the lower part of a 64-bit unsigned integer
variable as this is how DTLS epoch counter is defined.  DCI is
unrelated to the DTLS Connection ID <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>. The counters
initial value SHALL be three (3).<a href="#section-3-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.5">DTLS Message: variable length</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.6">
          <p id="section-3-4.6.1">One or more DTLS records. In cases more
 than one DTLS record is included all DTLS records except the last
 MUST include a length field. Note that this matches what is
 specified in DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> will always include the length
 field in each record.<a href="#section-3-4.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="PVALID-user-message">
<section id="section-4">
      <h2 id="name-protection-valid-message">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protection-valid-message" class="section-name selfRef">Protection Valid Message</a>
      </h2>
<p id="section-4-1">The Protection Valid message is sent from the Responder to the
Initiator when the Responder has confirmed reception of DTLS
chunk protected DTLS messages. This message triggers
requiring protection at the Initiator when it has been received.
Once received from the Initiator, the Protection Valid Message
is relayed back to the Responder. At reception of the message the
Responder will be enabled at sending Traffic.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The message SHALL be sent protected.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The message is 2 bytes and is 0x4F4B. This SCTP user message MUST be sent
reliably on Stream 0 with in order delivery in relation to any DTLS ACK message.<a href="#section-4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-chunk-integration">
<section id="section-5">
      <h2 id="name-dtls-chunk-integration">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dtls-chunk-integration" class="section-name selfRef">DTLS Chunk Integration</a>
      </h2>
<p id="section-5-1">The <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span> contains a high-level
description of the basic DTLS in SCTP architecture, this section deals
with details related to the DTLS 1.3 inband key-management
integration with SCTP.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="sctp-association-life-cycle">
<section id="section-5.1">
        <h3 id="name-sctp-association-life-cycle">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-sctp-association-life-cycle" class="section-name selfRef">SCTP Association Life Cycle.</a>
        </h3>
<p id="section-5.1-1">DTLS in SCTP uses inband key-management, thus the DTLS handshake
for a Key-Management DTLS Connection establishes a new DTLS
Connection with the remote peer from which both peers will derive
DTLS Key Contexts. As soon as the SCTP State Machine enters ESTABLISHED
state, DTLS in SCTP is responsible for progressing to where the DTLS
Chunk is fully configured and the ULP will be protected.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="protect-init">
<section id="section-5.1.1">
          <h4 id="name-protection-initialization">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-protection-initialization" class="section-name selfRef">Protection Initialization</a>
          </h4>
<p id="section-5.1.1-1">When the SCTP Association enter ESTABLISHED state, the initiator will
start the handshake according to <a href="#dtls-handshake" class="auto internal xref">Section 7.2</a>.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">When a successful handshake has been completed, the Primary DTLS Key
Context and the Restart DTLS Key Context will be created by deriving
the keys and IVs from the key-management DTLS connection. These will
be installed in the Chunks Protection Operator as defined in this document to
avoid dead lock, ensure successful protection and enabling the ULP
traffic.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp-association-ongoing">
<section id="section-5.1.2">
          <h4 id="name-sctp-association-ongoing">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-sctp-association-ongoing" class="section-name selfRef">SCTP Association Ongoing</a>
          </h4>
<p id="section-5.1.2-1">When an SCTP Association is protected the established Primary DTLS key
context is used for Chunk protection operation of the payload of SCTP
chunks in each packet per the DTLS Chunk specification
<span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">When necessary to meet requirements on key life time or periodic
re-authentication of the peer and establishment of new forward secrecy
keys, the existing DTLS 1.3 key-managment connection is being replaced
with a new one by first opening a new parallel DTLS connection as
further specified in <a href="#parallel-dtls" class="auto internal xref">Section 8</a>, derive and install new DTLS
Key Contexts and then close the old DTLS connection and remove the old
DTLS Key contexts.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="shutdown-states">
<section id="section-5.1.3">
          <h4 id="name-shutdown-states">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-shutdown-states" class="section-name selfRef">SHUTDOWN states</a>
          </h4>
<p id="section-5.1.3-1">When the SCTP association leaves the ESTABLISHED state per <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>
to be shutdown the DTLS Chunk's key contexts are kept and continue to
protect the SCTP packet payloads through the shutdown process.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3-2">When the association reaches the CLOSED state as part of the SCTP
association closing process, all DTLS connections existing
for this association are terminated without further
transmissions, i.e. DTLS close_notify is not transmitted.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-connection-handling">
<section id="section-5.2">
        <h3 id="name-dtls-connection-handling">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-dtls-connection-handling" class="section-name selfRef">DTLS Connection Handling</a>
        </h3>
<p id="section-5.2-1">It's up to DTLS key-management function to manage the DTLS
connections and their related DTLS Key context in the Chunk
Protection Operator.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="add-dtls-connection">
<section id="section-5.2.1">
          <h4 id="name-add-a-new-dtls-connection">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-add-a-new-dtls-connection" class="section-name selfRef">Add a New DTLS Connection</a>
          </h4>
<p id="section-5.2.1-1">Either peer can add a new DTLS connection to the SCTP association at
any time, but no more than 2 DTLS connections can exist at the same
time. Details of the handshake are described in <a href="#further_dtls_connection" class="auto internal xref">Section 7.2.2</a>.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">As either endpoint can initiate a DTLS handshake at the same time,
either endpoint may receive a DTLS ClientHello message when it has
sent its own ClientHello. In this case the ClientHello from the
endpoint that had the DTLS Client role in the establishment of the
previous DTLS connection shall be continued to be processed and the
other dropped.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">When the handshake has been completed successfully, the new DTLS Key
contexts are established by exporting keys and installing them in the
Chunk Protection Operator, and the new DTLS Key context are
immediately started to be used.
If the handshake is not completed successfully, a new DTLS
handshake attempt will be tried using the same DCI.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="remove-dtls-connection">
<section id="section-5.2.2">
          <h4 id="name-remove-an-existing-dtls-con">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-remove-an-existing-dtls-con" class="section-name selfRef">Remove an existing DTLS Connection</a>
          </h4>
<p id="section-5.2.2-1">A DTLS connection is removed when a
newer DTLS connection is in use. It is RECOMMENDED to not initiate
removal until at least one SCTP packet protected by the new DTLS Key Context
has been received, and any transmitted packets protected
using the new DTLS Key Context has been acknowledged, alternatively
waiting for one Maximum Segment Lifetime (120 seconds) has elapsed
since the last SCTP packet protected by the old DTLS connection was
transmitted.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">Either peers can initiate the removal of a DTLS connection from the
current SCTP association when needed when a new have been established.
The closing of the DTLS connection when the SCTP association is in
PROTECTED and ESTABLISHED state is done by having the DTLS connection
sending a DTLS close_notify. When the DTLS closure of a DTLS connection
is completed, the related DTLS Key Contexts (Primaryand Restart) in
the Chunk Protection Operator are released.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="removal_dtls_consideration">
<section id="section-5.2.3">
          <h4 id="name-considerations-about-remova">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-considerations-about-remova" class="section-name selfRef">Considerations about removal of DTLS Connections</a>
          </h4>
<p id="section-5.2.3-1">Removal of a DTLS connection may happen under circumstances as
described above in <a href="#remove-dtls-connection" class="auto internal xref">Section 5.2.2</a> in different states
of the Association. This section describes how the implementation
should take care of the DTLS connection removal in details:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-2.1">
              <p id="section-5.2.3-2.1.1">As long as one DTLS connection only exists, that DTLS
connection SHALL NOT be removed as it won't be possible for the
Association to proceed further.<a href="#section-5.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.2">
              <p id="section-5.2.3-2.2.1">A DTLS connection can be removed when there's another
active DTLS connection with valid DTLS Key Contexts that can be used
for negotiating further key-management DTLS 1.3 connections.<a href="#section-5.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.3">
              <p id="section-5.2.3-2.3.1">In case the DTLS connection is removed and no useable DTLS Key Context exist
for key-management DTLS 1.3 negotiation, the Association SHALL be
ABORTED.<a href="#section-5.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.3-3">It is up to the implementation to guarantee that a DTLS Key Context exists
all the time, for avoiding that undesired DTLS connection closure causes
the Association abortion.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-key-update">
<section id="section-5.3">
        <h3 id="name-dtls-key-update">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-dtls-key-update" class="section-name selfRef">DTLS Key Update</a>
        </h3>
<p id="section-5.3-1">DTLS Key Update MUST NOT be used.  DTLS Key Context replacement MUST
be used instead, by means of creating a new DTLS connection as specified
in <a href="#parallel-dtls" class="auto internal xref">Section 8</a>, deriving the new Primary DTLS Key Context, the
new Restart DTLS Key Context and then closing the old DTLS connection.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-cases">
<section id="section-5.4">
        <h3 id="name-error-cases">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-error-cases" class="section-name selfRef">Error Cases</a>
        </h3>
<p id="section-5.4-1">As DTLS has its own error reporting mechanism by exchanging DTLS alert
messages. No new DTLS related cause codes are defined to use the error
handling defined in <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">When the handshake of DTLS connection encounters an error it may report that
issue using DTLS alert message to its peer by putting the created DTLS
record in a SCTP user message (see <a href="#dtls-user-message" class="auto internal xref">Section 3</a>) with the
Handshake PPID. This is independent of what to do in relation to the
SCTP association.  Depending on the severity of the error different
decisions can be taken.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">However, as it is not expected that the key-management DTLS
connection will have any activity at all between completing the
handshake, and the DTLS connection closing, it is unlikely
that any error will occur.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-considerations">
<section id="section-6">
      <h2 id="name-dtls-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-dtls-considerations" class="section-name selfRef">DTLS Considerations</a>
      </h2>
<div id="version-of-dtls">
<section id="section-6.1">
        <h3 id="name-version-of-dtls">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-version-of-dtls" class="section-name selfRef">Version of DTLS</a>
        </h3>
<p id="section-6.1-1">This document defines the usage of DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>.
   Earlier versions of DTLS MUST NOT be used
   (see <span>[<a href="#RFC8996" class="cite xref">RFC8996</a>]</span>). It is expected that DTLS in SCTP as described in
   this document will work with future versions of DTLS.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Only one version of DTLS MUST be used during the lifetime of an
   SCTP Association, meaning that the procedure for replacing the DTLS
   version in use requires the existing SCTP Association to be
   terminated and a new SCTP Association with the desired DTLS version
   to be instantiated.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configuration-of-key-management-dtls">
<section id="section-6.2">
        <h3 id="name-configuration-of-key-manage">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-configuration-of-key-manage" class="section-name selfRef">Configuration of Key-Management DTLS</a>
        </h3>
<div id="general">
<section id="section-6.2.1">
          <h4 id="name-general">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-general" class="section-name selfRef">General</a>
          </h4>
<p id="section-6.2.1-1">The DTLS Connection ID SHOULD NOT be used in the Key-Management
   avoiding overhead and addition implementation
   requirements on DTLS implementation.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">The DTLS record length field is normally not needed as the DTLS
   Chunk provides a length field unless multiple records are put in
   same DTLS chunk payload or user message.
   Note that bundling is NOT PERMITED and only one DTLS Chunk can
   be transmitted in a SCTP Packet.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">DTLS record replay detection MUST be used.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<p id="section-6.2.1-4">Sequence number size can be adapted based on how quickly it wraps.<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<p id="section-6.2.1-5">Many of the TLS registries have a "Recommended" column. Parameters
   not marked as "Y" are NOT RECOMMENDED to support.
   Non-AEAD cipher suites or cipher suites without
   confidentiality MUST NOT be supported. Cipher suites and parameters
   that do not provide ephemeral key-exchange MUST NOT be supported.<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<p id="section-6.2.1-6">The Cipher suites negotiated in the Key-Management DTLS Connection
   SHALL only include those supported by the DTLS Chunk. The DTLS
   Chunk is expected to have an API capability to determine the Cipher
   Suit Capabilities, see Abstract API in Section 10 of
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>.<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-and-policy-decisions">
<section id="section-6.2.2">
          <h4 id="name-authentication-and-policy-d">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-authentication-and-policy-d" class="section-name selfRef">Authentication and Policy Decisions</a>
          </h4>
<p id="section-6.2.2-1">DTLS in SCTP MUST be mutually authenticated. Authentication is the
   process of establishing the identity of a user or system and
   verifying that the identity is valid. DTLS only provides proof of
   possession of a key. DTLS in SCTP MUST perform identity
   authentication. It is RECOMMENDED that DTLS in SCTP is used with
   certificate-based authentication.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">When certificates are used the application using DTLS in SCTP is
   responsible for certificate policies, certificate chain validation,
   and identity authentication (HTTPS does for example match the
   hostname with a subjectAltName of type dNSName). The application
   using DTLS in SCTP defines what the identity is and how it is
   encoded and the client and server MUST use the same identity
   format. Guidance on server certificate validation can be found in
   <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span>. DTLS in SCTP enables periodic transfer
   of mutual revocation information (OSCP stapling) every time a new
   parallel connection is set up. All security decisions MUST be based
   on the peer's authenticated identity, not on its transport layer
   identity.<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2.2-3">It is possible to authenticate DTLS endpoints based on IP addresses in
certificates. SCTP associations can use multiple IP addresses per SCTP
endpoint. Therefore, it is possible that DTLS records will be sent
from a different source IP address or to a different destination IP
address than that originally authenticated. This is not a problem
provided that no security decisions are made based on the source or
destination IP addresses.<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-connections">
<section id="section-6.2.3">
          <h4 id="name-new-connections">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-new-connections" class="section-name selfRef">New Connections</a>
          </h4>
<p id="section-6.2.3-1">Implementations MUST set up a new DTLS connection using a full handshake
before any of the certificates expire.
It is RECOMMENDED that all negotiated and
exchanged parameters are the same except for the timestamps in the
certificates. Clients and servers MUST NOT accept a change of identity
during the setup of a new connections, but MAY accept negotiation of
stronger algorithms and security parameters, which might be motivated
by new attacks.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2">Allowing new connections can enable denial-of-service attacks. The
endpoints MUST limit the number of simultaneous connections to two.<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
<p id="section-6.2.3-3">To force attackers to do dynamic key exfiltration and limit the
amount of compromised data due to key compromise, implementations MUST
have policies for how often to set up new connections with ephemeral
key exchange such as ECDHE. Implementations SHOULD set up new
connections frequently to force attackers to dynamic key
extraction. E.g., at least every hour and every 100 GB of data which
is a common policy for IPsec <span>[<a href="#ANSSI-DAT-NT-003" class="cite xref">ANSSI-DAT-NT-003</a>]</span>. See
<span>[<a href="#I-D.ietf-tls-rfc8446bis" class="cite xref">I-D.ietf-tls-rfc8446bis</a>]</span> for a more detailed discussion on key
compromise and key exfiltration in (D)TLS. As recommended in
<span>[<a href="#KTH-NCSA" class="cite xref">KTH-NCSA</a>]</span>, resumption can be used to chain the connections,
increasing security by forcing an adversary to break them in sequence.<a href="#section-6.2.3-3" class="pilcrow">¶</a></p>
<p id="section-6.2.3-4">For many DTLS in SCTP deployments the SCTP association is expected to
have a very long lifetime of months or even years. For associations
with such long lifetimes there is a need to frequently re-authenticate
both client and server by setting up a new connection using a full
handshake. TLS Certificate
lifetimes significantly shorter than a year are common which is
shorter than many expected SCTP associations protected by DTLS in
SCTP.<a href="#section-6.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-13">
<section id="section-6.2.4">
          <h4 id="name-dtls-13">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-dtls-13" class="section-name selfRef">DTLS 1.3</a>
          </h4>
<p id="section-6.2.4-1">DTLS 1.3 is used instead of DTLS 1.2 being a newer protocol that
addresses known vulnerabilities and only defines strong algorithms
without known major weaknesses at the time of publication.<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<p id="section-6.2.4-2">DTLS 1.3 requires rekeying before algorithm specific AEAD limits have
been reached. Implementations setup a new DTLS connection to handle
the need for new keys, alternatively terminate the SCTP Assocation.<a href="#section-6.2.4-2" class="pilcrow">¶</a></p>
<p id="section-6.2.4-3">In DTLS 1.3 any number of tickets can be issued in a connection and
the tickets can be used for resumption as long as they are valid,
which is up to seven days. The nodes in a resumed connection have the
same roles (client or server) as in the connection where the ticket
was issued. Resumption can have significant latency benefits for
quickly restarting a broken DTLS/SCTP association. If tickets and
resumption are used it is enough to issue a single ticket per
connection.<a href="#section-6.2.4-3" class="pilcrow">¶</a></p>
<p id="section-6.2.4-4">The PSK key exchange mode : psk_ke MUST NOT be used as it does not
provide ephemeral key exchange.<a href="#section-6.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="establishing-dtls-in-sctp">
<section id="section-7">
      <h2 id="name-establishing-dtls-in-sctp">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-establishing-dtls-in-sctp" class="section-name selfRef">Establishing DTLS in SCTP</a>
      </h2>
<p id="section-7-1">This section specifies how DTLS in SCTP is established using
   Key-Management DTLS Connections and the DTLS Chunk
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">A DTLS in SCTP Association is built up with a Key-Management DTLS
   connection, from that DTLS connection Primary DTLS Key Context and
   Restart DTLS Key Context are derived and the configures
   the DTLS Context.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The Key-Management DTLS connection is established as part of extra
   procedures for the DTLS chunk initial handshake (see
   <a href="#initial_dtls_connection" class="auto internal xref">Section 7.2.1</a>).<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="dtls-key-derivation">
<section id="section-7.1">
        <h3 id="name-dtls-key-context-derivation">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-dtls-key-context-derivation" class="section-name selfRef">DTLS Key Context derivation</a>
        </h3>
<p id="section-7.1-1">This section describes how DTLS Key Contexts are derived from the
  DTLS handshake using the TLS Exporter as defined by <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>. The
  TLS exporter label specifications below is following <span>[<a href="#RFC5705" class="cite xref">RFC5705</a>]</span>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">There are two sets of keys one for the Primary DTLS key context and
  one for the Restart DTLS Key Context. Each set consists of one
  client and one server side write key. In addition each key needs an
  Initilization Vector (IV) that is used by the record processing in
  TLS to create the nonce, See Section 5.3 of <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>. The client
  and server roles are here in relation to key-management DTLS session
  roles. So the DTLS Client will install the key derived using the
  EXPORTER_DTLS_IN_SCTP_PRIMARY_CLIENT_KEY label as its write key for
  the Primary DTLScontext, and use the
  EXPORTER_DTLS_IN_SCTP_PRIMARY_SERVER_KEY as its Primary DTLS context
  read key. Correspondlingly the
  EXPORTER_DTLS_IN_SCTP_RESTART_CLIENT_KEY is used to export the key
  used by the endpoint that acted as DTLS Client as write key for the
  restart DTLS key context. And the
  EXPORTER_DTLS_IN_SCTP_RESTART_SERVER_KEY as the DTLS client's read
  key for the restart DTLS Key Context. Correspondligy the IV values
  needs to be exported using the corresponding _IV label.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">The following labels are defined:<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.1">
            <p id="section-7.1-4.1.1">EXPORTER_DTLS_IN_SCTP_PRIMARY_CLIENT_KEY<a href="#section-7.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.2">
            <p id="section-7.1-4.2.1">EXPORTER_DTLS_IN_SCTP_PRIMARY_CLIENT_IV<a href="#section-7.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.3">
            <p id="section-7.1-4.3.1">EXPORTER_DTLS_IN_SCTP_PRIMARY_SERVER_KEY<a href="#section-7.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.4">
            <p id="section-7.1-4.4.1">EXPORTER_DTLS_IN_SCTP_PRIMARY_SERVER_IV<a href="#section-7.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.5">
            <p id="section-7.1-4.5.1">EXPORTER_DTLS_IN_SCTP_RESTART_CLIENT_KEY<a href="#section-7.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.6">
            <p id="section-7.1-4.6.1">EXPORTER_DTLS_IN_SCTP_RESTART_CLIENT_IV<a href="#section-7.1-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.7">
            <p id="section-7.1-4.7.1">EXPORTER_DTLS_IN_SCTP_RESTART_SERVER_KEY<a href="#section-7.1-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.8">
            <p id="section-7.1-4.8.1">EXPORTER_DTLS_IN_SCTP_RESTART_SERVER_IV<a href="#section-7.1-4.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-5">To ensure that downgrade attack on the protection solution offered
  is not possible the context used will be the full sequence of
  Protection Solution Identifiers as include in the DTLS 1.3 Chunk
  Protected Association (Section 4.1 of
  <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>) sent by the SCTP
  assocation initiator. Thus, any downgrade attack on this will result
  in a mismatch in produced keys as the initiator will use what it
  actually offered and the responder a truncated or modified sequence.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">The length of the exported key or IV material depends on the need for the
  negotiatated cipher suit for the protection.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-handshake">
<section id="section-7.2">
        <h3 id="name-dtls-handshake">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-dtls-handshake" class="section-name selfRef">DTLS Handshake</a>
        </h3>
<div id="initial_dtls_connection">
<section id="section-7.2.1">
          <h4 id="name-protection-initilization-us">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-protection-initilization-us" class="section-name selfRef">Protection Initilization using DTLS connection</a>
          </h4>
<p id="section-7.2.1-1">The handshake of the initial DTLS connection is part of the
   DTLS in SCTP Association initialization. The key-management DTLS
   connections progress interacts with the key installation
   for the SCTP associations DTLS chunk.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<span id="name-handshake-of-initial-dtls-c"></span><div id="sctp-DTLS-initial-dtls-connection">
<figure id="figure-4">
            <div id="section-7.2.1-2.1">
              <div class="alignCenter art-svg artwork" id="section-7.2.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="336" width="520" viewBox="0 0 520 336" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 40,48 L 40,304" fill="none" stroke="black"></path>
                  <path d="M 408,48 L 408,304" fill="none" stroke="black"></path>
                  <path d="M 440,64 L 440,112" fill="none" stroke="black"></path>
                  <path d="M 440,160 L 440,208" fill="none" stroke="black"></path>
                  <path d="M 440,256 L 440,304" fill="none" stroke="black"></path>
                  <path d="M 40,64 L 200,64" fill="none" stroke="black"></path>
                  <path d="M 256,64 L 400,64" fill="none" stroke="black"></path>
                  <path d="M 48,80 L 184,80" fill="none" stroke="black"></path>
                  <path d="M 272,80 L 408,80" fill="none" stroke="black"></path>
                  <path d="M 40,96 L 168,96" fill="none" stroke="black"></path>
                  <path d="M 280,96 L 400,96" fill="none" stroke="black"></path>
                  <path d="M 440,96 L 480,96" fill="none" stroke="black"></path>
                  <path d="M 48,112 L 176,112" fill="none" stroke="black"></path>
                  <path d="M 280,112 L 408,112" fill="none" stroke="black"></path>
                  <path d="M 40,160 L 120,160" fill="none" stroke="black"></path>
                  <path d="M 328,160 L 400,160" fill="none" stroke="black"></path>
                  <path d="M 48,176 L 64,176" fill="none" stroke="black"></path>
                  <path d="M 376,176 L 408,176" fill="none" stroke="black"></path>
                  <path d="M 40,192 L 64,192" fill="none" stroke="black"></path>
                  <path d="M 368,192 L 400,192" fill="none" stroke="black"></path>
                  <path d="M 440,192 L 480,192" fill="none" stroke="black"></path>
                  <path d="M 48,208 L 152,208" fill="none" stroke="black"></path>
                  <path d="M 288,208 L 408,208" fill="none" stroke="black"></path>
                  <path d="M 40,256 L 96,256" fill="none" stroke="black"></path>
                  <path d="M 328,256 L 400,256" fill="none" stroke="black"></path>
                  <path d="M 48,272 L 104,272" fill="none" stroke="black"></path>
                  <path d="M 336,272 L 408,272" fill="none" stroke="black"></path>
                  <path d="M 440,272 L 512,272" fill="none" stroke="black"></path>
                  <path d="M 424,48 C 432.83064,48 440,55.16936 440,64" fill="none" stroke="black"></path>
                  <path d="M 424,128 C 432.83064,128 440,120.83064 440,112" fill="none" stroke="black"></path>
                  <path d="M 424,144 C 432.83064,144 440,151.16936 440,160" fill="none" stroke="black"></path>
                  <path d="M 424,224 C 432.83064,224 440,216.83064 440,208" fill="none" stroke="black"></path>
                  <path d="M 424,240 C 432.83064,240 440,247.16936 440,256" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="408,256 396,250.4 396,261.6" fill="black" transform="rotate(0,400,256)"></polygon>
                  <polygon class="arrowhead" points="408,192 396,186.4 396,197.6" fill="black" transform="rotate(0,400,192)"></polygon>
                  <polygon class="arrowhead" points="408,160 396,154.4 396,165.6" fill="black" transform="rotate(0,400,160)"></polygon>
                  <polygon class="arrowhead" points="408,96 396,90.4 396,101.6" fill="black" transform="rotate(0,400,96)"></polygon>
                  <polygon class="arrowhead" points="408,64 396,58.4 396,69.6" fill="black" transform="rotate(0,400,64)"></polygon>
                  <polygon class="arrowhead" points="56,272 44,266.4 44,277.6" fill="black" transform="rotate(180,48,272)"></polygon>
                  <polygon class="arrowhead" points="56,208 44,202.4 44,213.6" fill="black" transform="rotate(180,48,208)"></polygon>
                  <polygon class="arrowhead" points="56,176 44,170.4 44,181.6" fill="black" transform="rotate(180,48,176)"></polygon>
                  <polygon class="arrowhead" points="56,112 44,106.4 44,117.6" fill="black" transform="rotate(180,48,112)"></polygon>
                  <polygon class="arrowhead" points="56,80 44,74.4 44,85.6" fill="black" transform="rotate(180,48,80)"></polygon>
                  <g class="text">
                    <text x="40" y="36">Initiator</text>
                    <text x="408" y="36">Responder</text>
                    <text x="228" y="68">[INIT]</text>
                    <text x="228" y="84">[INIT-ACK]</text>
                    <text x="468" y="84">SCTP</text>
                    <text x="200" y="100">[COOKIE</text>
                    <text x="256" y="100">ECHO]</text>
                    <text x="208" y="116">[COOKIE</text>
                    <text x="260" y="116">ACK]</text>
                    <text x="164" y="164">[DATA(DTLS</text>
                    <text x="236" y="164">Client</text>
                    <text x="296" y="164">Hello)]</text>
                    <text x="108" y="180">[DATA(DTLS</text>
                    <text x="180" y="180">Server</text>
                    <text x="232" y="180">Hello</text>
                    <text x="272" y="180">...</text>
                    <text x="332" y="180">Finished)]</text>
                    <text x="468" y="180">DTLS</text>
                    <text x="108" y="196">[DATA(DTLS</text>
                    <text x="200" y="196">Certificate</text>
                    <text x="264" y="196">...</text>
                    <text x="324" y="196">Finished)]</text>
                    <text x="196" y="212">[DATA(DTLS</text>
                    <text x="264" y="212">ACK)]</text>
                    <text x="120" y="260">[DTLS</text>
                    <text x="204" y="260">CHUNK(DATA(APP</text>
                    <text x="296" y="260">DATA))]</text>
                    <text x="464" y="260">APP</text>
                    <text x="500" y="260">DATA</text>
                    <text x="128" y="276">[DTLS</text>
                    <text x="212" y="276">CHUNK(DATA(APP</text>
                    <text x="304" y="276">DATA))]</text>
                    <text x="216" y="292">...</text>
                    <text x="216" y="308">...</text>
                  </g>
                </svg><a href="#section-7.2.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-handshake-of-initial-dtls-c" class="selfRef">Handshake of initial DTLS connection</a>
            </figcaption></figure>
</div>
<p id="section-7.2.1-3">SCTP Handshake is strictly compliant to <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>. The DTLS 1.3
   Chunk Protected Association parameter (Section 4.1 of
   <span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>) is included containing
   the Protection Solution identifier (See <a href="#sec-iana-psi" class="auto internal xref">Section 10.1</a>) for this
   documents key-management at a suitable preference position
   depending on local policy. And in case this key-management solution
   is the most preferred then the process continues as stated below
   and depiceted in <a href="#sctp-protection-initilization" class="auto internal xref">Figure 5</a>.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<span id="name-the-steps-of-interaction-be"></span><div id="sctp-protection-initilization">
<figure id="figure-5">
            <div id="section-7.2.1-4.1">
              <div class="alignCenter art-svg artwork" id="section-7.2.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="448" width="576" viewBox="0 0 576 448" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 40,48 L 40,416" fill="none" stroke="black"></path>
                  <path d="M 80,160 L 80,336" fill="none" stroke="black"></path>
                  <path d="M 424,160 L 424,336" fill="none" stroke="black"></path>
                  <path d="M 464,48 L 464,416" fill="none" stroke="black"></path>
                  <path d="M 496,368 L 496,416" fill="none" stroke="black"></path>
                  <path d="M 40,64 L 232,64" fill="none" stroke="black"></path>
                  <path d="M 288,64 L 456,64" fill="none" stroke="black"></path>
                  <path d="M 48,80 L 216,80" fill="none" stroke="black"></path>
                  <path d="M 304,80 L 464,80" fill="none" stroke="black"></path>
                  <path d="M 40,96 L 200,96" fill="none" stroke="black"></path>
                  <path d="M 312,96 L 456,96" fill="none" stroke="black"></path>
                  <path d="M 48,112 L 208,112" fill="none" stroke="black"></path>
                  <path d="M 312,112 L 464,112" fill="none" stroke="black"></path>
                  <path d="M 40,176 L 72,176" fill="none" stroke="black"></path>
                  <path d="M 432,176 L 464,176" fill="none" stroke="black"></path>
                  <path d="M 80,208 L 152,208" fill="none" stroke="black"></path>
                  <path d="M 360,208 L 416,208" fill="none" stroke="black"></path>
                  <path d="M 408,224 L 424,224" fill="none" stroke="black"></path>
                  <path d="M 80,240 L 96,240" fill="none" stroke="black"></path>
                  <path d="M 400,240 L 416,240" fill="none" stroke="black"></path>
                  <path d="M 88,256 L 104,256" fill="none" stroke="black"></path>
                  <path d="M 400,256 L 424,256" fill="none" stroke="black"></path>
                  <path d="M 80,272 L 104,272" fill="none" stroke="black"></path>
                  <path d="M 400,272 L 416,272" fill="none" stroke="black"></path>
                  <path d="M 48,304 L 80,304" fill="none" stroke="black"></path>
                  <path d="M 424,304 L 456,304" fill="none" stroke="black"></path>
                  <path d="M 40,368 L 136,368" fill="none" stroke="black"></path>
                  <path d="M 368,368 L 456,368" fill="none" stroke="black"></path>
                  <path d="M 48,384 L 136,384" fill="none" stroke="black"></path>
                  <path d="M 368,384 L 464,384" fill="none" stroke="black"></path>
                  <path d="M 496,384 L 568,384" fill="none" stroke="black"></path>
                  <path d="M 480,352 C 488.83064,352 496,359.16936 496,368" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="464,368 452,362.4 452,373.6" fill="black" transform="rotate(0,456,368)"></polygon>
                  <polygon class="arrowhead" points="464,304 452,298.4 452,309.6" fill="black" transform="rotate(0,456,304)"></polygon>
                  <polygon class="arrowhead" points="464,96 452,90.4 452,101.6" fill="black" transform="rotate(0,456,96)"></polygon>
                  <polygon class="arrowhead" points="464,64 452,58.4 452,69.6" fill="black" transform="rotate(0,456,64)"></polygon>
                  <polygon class="arrowhead" points="440,176 428,170.4 428,181.6" fill="black" transform="rotate(180,432,176)"></polygon>
                  <polygon class="arrowhead" points="424,272 412,266.4 412,277.6" fill="black" transform="rotate(0,416,272)"></polygon>
                  <polygon class="arrowhead" points="424,240 412,234.4 412,245.6" fill="black" transform="rotate(0,416,240)"></polygon>
                  <polygon class="arrowhead" points="424,208 412,202.4 412,213.6" fill="black" transform="rotate(0,416,208)"></polygon>
                  <polygon class="arrowhead" points="96,256 84,250.4 84,261.6" fill="black" transform="rotate(180,88,256)"></polygon>
                  <polygon class="arrowhead" points="80,176 68,170.4 68,181.6" fill="black" transform="rotate(0,72,176)"></polygon>
                  <polygon class="arrowhead" points="56,384 44,378.4 44,389.6" fill="black" transform="rotate(180,48,384)"></polygon>
                  <polygon class="arrowhead" points="56,304 44,298.4 44,309.6" fill="black" transform="rotate(180,48,304)"></polygon>
                  <polygon class="arrowhead" points="56,112 44,106.4 44,117.6" fill="black" transform="rotate(180,48,112)"></polygon>
                  <polygon class="arrowhead" points="56,80 44,74.4 44,85.6" fill="black" transform="rotate(180,48,80)"></polygon>
                  <g class="text">
                    <text x="40" y="36">Initiator</text>
                    <text x="464" y="36">Responder</text>
                    <text x="20" y="68">0.</text>
                    <text x="260" y="68">[INIT]</text>
                    <text x="260" y="84">[INIT-ACK]</text>
                    <text x="232" y="100">[COOKIE</text>
                    <text x="288" y="100">ECHO]</text>
                    <text x="484" y="100">1.</text>
                    <text x="20" y="116">2.</text>
                    <text x="240" y="116">[COOKIE</text>
                    <text x="292" y="116">ACK]</text>
                    <text x="72" y="148">Key</text>
                    <text x="120" y="148">Manager</text>
                    <text x="376" y="148">Key</text>
                    <text x="424" y="148">Manager</text>
                    <text x="20" y="180">3.</text>
                    <text x="116" y="180">CRYPTO</text>
                    <text x="156" y="180">UP</text>
                    <text x="364" y="180">CRYPTO</text>
                    <text x="404" y="180">UP</text>
                    <text x="196" y="212">[DATA(DTLS</text>
                    <text x="268" y="212">Client</text>
                    <text x="328" y="212">Hello)]</text>
                    <text x="444" y="212">4.</text>
                    <text x="132" y="228">&lt;-[DATA(DTLS</text>
                    <text x="212" y="228">Server</text>
                    <text x="264" y="228">Hello</text>
                    <text x="304" y="228">...</text>
                    <text x="364" y="228">Finished)]</text>
                    <text x="444" y="228">5.</text>
                    <text x="60" y="244">6.</text>
                    <text x="140" y="244">[DATA(DTLS</text>
                    <text x="232" y="244">Certificate</text>
                    <text x="296" y="244">...</text>
                    <text x="356" y="244">Finished)]</text>
                    <text x="444" y="244">7.</text>
                    <text x="128" y="260">[DTLS</text>
                    <text x="216" y="260">CHUNK(DATA(DTLS</text>
                    <text x="300" y="260">ACK,</text>
                    <text x="360" y="260">PVALID))]</text>
                    <text x="444" y="260">8.</text>
                    <text x="128" y="276">[DTLS</text>
                    <text x="216" y="276">CHUNK(DATA(DTLS</text>
                    <text x="300" y="276">ACK,</text>
                    <text x="360" y="276">PVALID))]</text>
                    <text x="444" y="276">9.</text>
                    <text x="128" y="308">VALIDATED</text>
                    <text x="376" y="308">VALIDATED</text>
                    <text x="16" y="372">10.</text>
                    <text x="160" y="372">[DTLS</text>
                    <text x="244" y="372">CHUNK(DATA(APP</text>
                    <text x="336" y="372">DATA))]</text>
                    <text x="520" y="372">APP</text>
                    <text x="556" y="372">DATA</text>
                    <text x="160" y="388">[DTLS</text>
                    <text x="244" y="388">CHUNK(DATA(APP</text>
                    <text x="336" y="388">DATA))]</text>
                    <text x="256" y="404">...</text>
                    <text x="256" y="420">...</text>
                  </g>
                </svg><a href="#section-7.2.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-the-steps-of-interaction-be" class="selfRef">The steps of Interaction between Key-Management and DTLS Chunk API</a>
            </figcaption></figure>
</div>
<ol start="1" type="1" class="normal type-1" id="section-7.2.1-5">
<li id="section-7.2.1-5.1">
              <p id="section-7.2.1-5.1.1">The Initiator initiates an SCTP Association and provides the
DTLS 1.3 Chunk Protected Association parameter preference
ordered list of supporter Protection Solutions. The offered
parameter list is remembered by the Key-Management.<a href="#section-7.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.2">
              <p id="section-7.2.1-5.2.1">The Responder peer enter SCTP Established, and the
Key-Management is provided with the full ordered list of
Protection Solutions offered in the INIT Chunk.<a href="#section-7.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.3">
              <p id="section-7.2.1-5.3.1">The Initiator enters SCTP Assocationa Established and the
Key-Management is triggered to perform the next step.<a href="#section-7.2.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.4">
              <p id="section-7.2.1-5.4.1">Key-Management initiated a DTLS handshake with the the supported
configuration. Taking supported Cipher-suits in the DTLS Chunk
implementation into account when creating its DTLS Client-Hello
mesage. The DTLS messages are sent per <a href="#dtls-user-message" class="auto internal xref">Section 3</a><a href="#section-7.2.1-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.5">
              <p id="section-7.2.1-5.5.1">Responder receives DTLS Client-Hello and generates
the DTLS Server Hello, etc response message(s) for the DTLS handshake.
In case the DTLS server in the responder requires the use of the
retry message an additional message exchange between DTLS Client
and DTLS server is needed before one can progress to 5.<a href="#section-7.2.1-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.6">
              <p id="section-7.2.1-5.6.1">Responder uses its the TLS Exporter on the DTLS Connection's
state to derive the primary client write key and IV
<a href="#dtls-key-derivation" class="auto internal xref">Section 7.1</a> and install them into the Chunk
Protection Operator's Primary Key Context.
Then it sends the DTLS Server's response message(s).<a href="#section-7.2.1-5.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.7">
              <p id="section-7.2.1-5.7.1">The DTLS client receives the DTLS server's messages (Server
Hello etc.)  and can now export both the client and server write
key for the Primary and Restart Key Contexts, however their usage
is not yet required and SCTP packets without DTLS chunks are still
accepted. Then the DTLS Client next handshake message is sent.
This message SHALL be protected by the DTLS Chunk using the Primary
key Context (Client Write key and IV).<a href="#section-7.2.1-5.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.8">
              <p id="section-7.2.1-5.8.1">The responder's Chunk Protection Operator will receive the SCTP
packets containing the DTLS chunk protected DTLS messages,
concluding the main process of the DTLS handshake.<a href="#section-7.2.1-5.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.9">
              <p id="section-7.2.1-5.9.1">The responder exports the remaining keys and IVs and installs all
Primary and Restart Server Write Key and IV, as well as restart
client write key and IV. After that it requires all future SCTP
Packets to be protected by DTLS Chunk. If any DTLS ACK message
is to be sent, it SHOULD be sent next.  Then it sends a
protected Protection Valid Message <a href="#PVALID-user-message" class="auto internal xref">Section 4</a> to
the SCTP Association Initiators Key-Management.<a href="#section-7.2.1-5.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.10">
              <p id="section-7.2.1-5.10.1">Having received the Protection Valid Message, the initiator's
key-management can now inform the ULP that the SCTP association
is protected and verified. It shall also send a Protection Validation
Message to the responder.
Upon successful reception of the Protection Valid Message the
Initiator's Key-Management configure the DTLS Chunk to
only accept DTLS Chunk Protected SCTP packets.
Upon successful reception of the Protection Valid Message the
Responder's Key-Management informs the SCTP stack that
the Association is Validated and traffic can be sent.<a href="#section-7.2.1-5.10.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.1-5.11">
              <p id="section-7.2.1-5.11.1">The Initiator's ULP is notified that the SCTP association is
Established and protected and it may generate user messages.<a href="#section-7.2.1-5.11.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-7.2.1-6">If the DTLS handshake fails the SCTP association SHALL be aborted
   and an ERROR chunk with the Error in Protection error cause, with
   the appropriate extra error causes is generated, the right
   selection of "Error During Protection Handshake" or "Timeout During
   Protection Handshake or Validation".<a href="#section-7.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="further_dtls_connection">
<section id="section-7.2.2">
          <h4 id="name-handshake-of-further-dtls-c">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-handshake-of-further-dtls-c" class="section-name selfRef">Handshake of further DTLS connections</a>
          </h4>
<p id="section-7.2.2-1">When the SCTP Association has entered the PROTECTED state, each of
   the endpoint can initiate a DTLS handshake for Key-Management when
   necessary.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">The DTLS Key-Management will act as a User of SCTP, identified
   with the Key-Management PPID 4242. DTLS handshake
   is sent as a SCTP user message according to <a href="#dtls-user-message" class="auto internal xref">Section 3</a>.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3">The DTLS instance SHOULD NOT use DTLS retransmission to repair any
   packet losses of handshake message fragment.
   If the DTLS
   implementation support configuring a MTU larger than the actual IP
   MTU it could be used as SCTP provides reliability and
   fragmentation.<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2.2-4">If the DTLS handshake fails the SCTP association SHALL generate
   an ERROR chunk with the Error in Protection error cause, with
   extra error causes "Error During Protection Handshake".<a href="#section-7.2.2-4" class="pilcrow">¶</a></p>
<span id="name-handshake-of-further-dtls-co"></span><div id="sctp-DTLS-further-dtls-connection">
<figure id="figure-6">
            <div id="section-7.2.2-5.1">
              <div class="alignCenter art-svg artwork" id="section-7.2.2-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="528" viewBox="0 0 528 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 40,48 L 40,128" fill="none" stroke="black"></path>
                  <path d="M 488,48 L 488,128" fill="none" stroke="black"></path>
                  <path d="M 40,64 L 104,64" fill="none" stroke="black"></path>
                  <path d="M 408,64 L 480,64" fill="none" stroke="black"></path>
                  <path d="M 48,80 L 64,80" fill="none" stroke="black"></path>
                  <path d="M 472,80 L 488,80" fill="none" stroke="black"></path>
                  <path d="M 40,96 L 64,96" fill="none" stroke="black"></path>
                  <path d="M 464,96 L 480,96" fill="none" stroke="black"></path>
                  <path d="M 48,112 L 144,112" fill="none" stroke="black"></path>
                  <path d="M 376,112 L 488,112" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="488,96 476,90.4 476,101.6" fill="black" transform="rotate(0,480,96)"></polygon>
                  <polygon class="arrowhead" points="488,64 476,58.4 476,69.6" fill="black" transform="rotate(0,480,64)"></polygon>
                  <polygon class="arrowhead" points="56,112 44,106.4 44,117.6" fill="black" transform="rotate(180,48,112)"></polygon>
                  <polygon class="arrowhead" points="56,80 44,74.4 44,85.6" fill="black" transform="rotate(180,48,80)"></polygon>
                  <g class="text">
                    <text x="40" y="36">Initiator</text>
                    <text x="488" y="36">Responder</text>
                    <text x="128" y="68">[DTLS</text>
                    <text x="216" y="68">CHUNK(DATA(DTLS</text>
                    <text x="308" y="68">Client</text>
                    <text x="372" y="68">Hello))]</text>
                    <text x="88" y="84">[DTLS</text>
                    <text x="176" y="84">CHUNK(DATA(DTLS</text>
                    <text x="268" y="84">Server</text>
                    <text x="320" y="84">Hello</text>
                    <text x="360" y="84">...</text>
                    <text x="424" y="84">Finished))]</text>
                    <text x="88" y="100">[DTLS</text>
                    <text x="176" y="100">CHUNK(DATA(DTLS</text>
                    <text x="288" y="100">Certificate</text>
                    <text x="352" y="100">...</text>
                    <text x="416" y="100">Finished))]</text>
                    <text x="168" y="116">[DTLS</text>
                    <text x="256" y="116">CHUNK(DATA(DTLS</text>
                    <text x="348" y="116">ACK))]</text>
                  </g>
                </svg><a href="#section-7.2.2-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-handshake-of-further-dtls-co" class="selfRef">Handshake of further DTLS connection</a>
            </figcaption></figure>
</div>
<p id="section-7.2.2-6">The <a href="#sctp-DTLS-further-dtls-connection" class="auto internal xref">Figure 6</a> shows a successful
handshake of a further DTLS connection. Such connections can
be initiated by any of the peers. Here DTLS handshake messages
are transported by means of DATA chunks with the DTLS Chunk
Key-Management Messages PPID inside DTLS Chunks.<a href="#section-7.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sctp-restart">
<section id="section-7.3">
        <h3 id="name-sctp-association-restart">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-sctp-association-restart" class="section-name selfRef">SCTP Association Restart</a>
        </h3>
<p id="section-7.3-1">In order to achieve an Association Restart as described in
<span>[<a href="#I-D.draft-ietf-tsvwg-sctp-dtls-chunk" class="cite xref">I-D.draft-ietf-tsvwg-sctp-dtls-chunk</a>]</span>, a Restart DTLS Key Context
dedicated to Restart SHALL exist and be available.  Furthermore, both
peers SHALL have safely stored both the current Restart DTLS Key Context.
Here we assume that Restart DTLS Key Context is maintained across
the events leading to SCTP Restart request.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div id="init-dtls-restart-context">
<section id="section-7.3.1">
          <h4 id="name-installation-of-initial-res">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-installation-of-initial-res" class="section-name selfRef">Installation of initial Restart DTLS Key Context</a>
          </h4>
<p id="section-7.3.1-1">As soon as the Association has reached the ESTABLISHED state
and before the Primary DTLS Key context have been installed a
Restart DTLS Key Context SHALL be derived and then installed.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">It MAY exist a short time gap where the Association has already
been validated state but no Restart DTLS Key Context has been installed
yet. If a SCTP Restart procedure will be initiated during that time,
it will fail and the Association will also fail. However, this is
unlikely as the Restart Init will be sent multiple times following a
exponential back-off timer and in that time the Restart DTLS Key Context is
expected to be in place.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
<p id="section-7.3.1-3">Once installed, no traffic will be sent over the Restart DTLS Key Context
so that both endpoints will have a known DTLS context state, i.e. the
Sequence number and replay window are both just initialized to default
values for the epoch=3.<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="installation-of-restart-dtls-key-context-for-further-dtls-connections">
<section id="section-7.3.2">
          <h4 id="name-installation-of-restart-dtl">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-installation-of-restart-dtl" class="section-name selfRef">Installation of Restart DTLS Key Context for further DTLS Connections</a>
          </h4>
<p id="section-7.3.2-1">As each subsequent Key-Management DTLS connection completes the DTLS handshake
and the Primary DTLS Key context has been derived and installed also
the Restart DTLS Key context SHALL be installed. The closing of the previous
DTLS connection SHALL NOT be initiated or completed until the Restart
DTLS Key Context is in place.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp-assoc-restart-procedure">
<section id="section-7.3.3">
          <h4 id="name-sctp-association-restart-pr">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-sctp-association-restart-pr" class="section-name selfRef">SCTP Association Restart Procedure</a>
          </h4>
<p id="section-7.3.3-1">The DTLS in SCTP Association Restart is meant to preserve the security
characteristics.<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3.3-2">In order the Association Restart to proceed both Initiator and Responder
SHALL use the same Restart DTLS Key Context for COOKIE-ECHO/COOKIE-ACK
handshake, that implies that the Initiator must preserve the Restart
DTLS Key Context and that the Responder SHALL NOT change the Restart
DTLS Key Context during the Restart procedure.<a href="#section-7.3.3-2" class="pilcrow">¶</a></p>
<span id="name-sctp-restart-sequence-for-d"></span><div id="sctp-assoc-restart-sequence">
<figure id="figure-7">
            <div id="section-7.3.3-3.1">
              <div class="alignCenter art-svg artwork" id="section-7.3.3-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="568" viewBox="0 0 568 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 40,48 L 40,464" fill="none" stroke="black"></path>
                  <path d="M 432,48 L 432,464" fill="none" stroke="black"></path>
                  <path d="M 464,64 L 464,240" fill="none" stroke="black"></path>
                  <path d="M 464,288 L 464,368" fill="none" stroke="black"></path>
                  <path d="M 464,416 L 464,464" fill="none" stroke="black"></path>
                  <path d="M 40,64 L 160,64" fill="none" stroke="black"></path>
                  <path d="M 312,64 L 424,64" fill="none" stroke="black"></path>
                  <path d="M 48,80 L 144,80" fill="none" stroke="black"></path>
                  <path d="M 328,80 L 432,80" fill="none" stroke="black"></path>
                  <path d="M 464,80 L 520,80" fill="none" stroke="black"></path>
                  <path d="M 40,128 L 136,128" fill="none" stroke="black"></path>
                  <path d="M 344,128 L 424,128" fill="none" stroke="black"></path>
                  <path d="M 48,144 L 136,144" fill="none" stroke="black"></path>
                  <path d="M 336,144 L 432,144" fill="none" stroke="black"></path>
                  <path d="M 464,144 L 520,144" fill="none" stroke="black"></path>
                  <path d="M 40,192 L 64,192" fill="none" stroke="black"></path>
                  <path d="M 368,192 L 424,192" fill="none" stroke="black"></path>
                  <path d="M 48,208 L 64,208" fill="none" stroke="black"></path>
                  <path d="M 40,224 L 64,224" fill="none" stroke="black"></path>
                  <path d="M 400,224 L 424,224" fill="none" stroke="black"></path>
                  <path d="M 48,240 L 112,240" fill="none" stroke="black"></path>
                  <path d="M 344,240 L 432,240" fill="none" stroke="black"></path>
                  <path d="M 464,240 L 552,240" fill="none" stroke="black"></path>
                  <path d="M 464,368 L 560,368" fill="none" stroke="black"></path>
                  <path d="M 40,416 L 104,416" fill="none" stroke="black"></path>
                  <path d="M 336,416 L 424,416" fill="none" stroke="black"></path>
                  <path d="M 48,432 L 104,432" fill="none" stroke="black"></path>
                  <path d="M 336,432 L 432,432" fill="none" stroke="black"></path>
                  <path d="M 464,432 L 536,432" fill="none" stroke="black"></path>
                  <path d="M 448,48 C 456.83064,48 464,55.16936 464,64" fill="none" stroke="black"></path>
                  <path d="M 448,256 C 456.83064,256 464,248.83064 464,240" fill="none" stroke="black"></path>
                  <path d="M 448,272 C 456.83064,272 464,279.16936 464,288" fill="none" stroke="black"></path>
                  <path d="M 448,384 C 456.83064,384 464,376.83064 464,368" fill="none" stroke="black"></path>
                  <path d="M 448,400 C 456.83064,400 464,407.16936 464,416" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="432,416 420,410.4 420,421.6" fill="black" transform="rotate(0,424,416)"></polygon>
                  <polygon class="arrowhead" points="432,224 420,218.4 420,229.6" fill="black" transform="rotate(0,424,224)"></polygon>
                  <polygon class="arrowhead" points="432,192 420,186.4 420,197.6" fill="black" transform="rotate(0,424,192)"></polygon>
                  <polygon class="arrowhead" points="432,128 420,122.4 420,133.6" fill="black" transform="rotate(0,424,128)"></polygon>
                  <polygon class="arrowhead" points="432,64 420,58.4 420,69.6" fill="black" transform="rotate(0,424,64)"></polygon>
                  <polygon class="arrowhead" points="56,432 44,426.4 44,437.6" fill="black" transform="rotate(180,48,432)"></polygon>
                  <polygon class="arrowhead" points="56,240 44,234.4 44,245.6" fill="black" transform="rotate(180,48,240)"></polygon>
                  <polygon class="arrowhead" points="56,208 44,202.4 44,213.6" fill="black" transform="rotate(180,48,208)"></polygon>
                  <polygon class="arrowhead" points="56,144 44,138.4 44,149.6" fill="black" transform="rotate(180,48,144)"></polygon>
                  <polygon class="arrowhead" points="56,80 44,74.4 44,85.6" fill="black" transform="rotate(180,48,80)"></polygon>
                  <g class="text">
                    <text x="40" y="36">Initiator</text>
                    <text x="432" y="36">Responder</text>
                    <text x="184" y="68">[DTLS</text>
                    <text x="260" y="68">CHUNK(INIT)]</text>
                    <text x="168" y="84">[DTLS</text>
                    <text x="260" y="84">CHUNK(INIT-ACK)]</text>
                    <text x="496" y="100">Using</text>
                    <text x="492" y="116">DTLS</text>
                    <text x="160" y="132">[DTLS</text>
                    <text x="236" y="132">CHUNK(COOKIE</text>
                    <text x="316" y="132">ECHO)]</text>
                    <text x="500" y="132">Chunks</text>
                    <text x="160" y="148">[DTLS</text>
                    <text x="236" y="148">CHUNK(COOKIE</text>
                    <text x="312" y="148">ACK)]</text>
                    <text x="88" y="196">[DTLS</text>
                    <text x="176" y="196">CHUNK(DATA(DTLS</text>
                    <text x="268" y="196">Client</text>
                    <text x="332" y="196">Hello))]</text>
                    <text x="88" y="212">[DTLS</text>
                    <text x="176" y="212">CHUNK(DATA(DTLS</text>
                    <text x="268" y="212">Server</text>
                    <text x="312" y="212">...</text>
                    <text x="380" y="212">Finished))]-</text>
                    <text x="488" y="212">New</text>
                    <text x="524" y="212">DTLS</text>
                    <text x="88" y="228">[DTLS</text>
                    <text x="176" y="228">CHUNK(DATA(DTLS</text>
                    <text x="272" y="228">Cert...</text>
                    <text x="352" y="228">Finished))]</text>
                    <text x="516" y="228">Connection</text>
                    <text x="136" y="244">[DTLS</text>
                    <text x="224" y="244">CHUNK(DATA(DTLS</text>
                    <text x="316" y="244">ACK))]</text>
                    <text x="240" y="276">...</text>
                    <text x="240" y="292">...</text>
                    <text x="500" y="292">Derive</text>
                    <text x="544" y="292">new</text>
                    <text x="240" y="308">...</text>
                    <text x="504" y="308">Primary</text>
                    <text x="552" y="308">and</text>
                    <text x="240" y="324">...</text>
                    <text x="504" y="324">Restart</text>
                    <text x="240" y="340">...</text>
                    <text x="492" y="340">DTLS</text>
                    <text x="528" y="340">Key</text>
                    <text x="240" y="356">...</text>
                    <text x="508" y="356">Contexts</text>
                    <text x="240" y="372">...</text>
                    <text x="240" y="388">...</text>
                    <text x="128" y="420">[DTLS</text>
                    <text x="212" y="420">CHUNK(DATA(APP</text>
                    <text x="304" y="420">DATA))]</text>
                    <text x="488" y="420">APP</text>
                    <text x="524" y="420">DATA</text>
                    <text x="128" y="436">[DTLS</text>
                    <text x="212" y="436">CHUNK(DATA(APP</text>
                    <text x="304" y="436">DATA))]</text>
                    <text x="240" y="452">...</text>
                    <text x="240" y="468">...</text>
                  </g>
                </svg><a href="#section-7.3.3-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-sctp-restart-sequence-for-d" class="selfRef">SCTP Restart sequence for DTLS in SCTP</a>
            </figcaption></figure>
</div>
<p id="section-7.3.3-4">The <a href="#sctp-assoc-restart-sequence" class="auto internal xref">Figure 7</a> shows a successful
SCTP Association Restart.<a href="#section-7.3.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3.3-5">From procedure viewpoint the sequence is the following:<a href="#section-7.3.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.3-6.1">
              <p id="section-7.3.3-6.1.1">Initiator sends INIT (VTag=0), Responder replies INIT-ACK
both encrypted using Restart DTLS Key Context<a href="#section-7.3.3-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-6.2">
              <p id="section-7.3.3-6.2.1">Initiator sends COOKIE-ECHO using DTLS CHUNK encrypted with the Key
tied to the Restart DTLS Key Context<a href="#section-7.3.3-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-6.3">
              <p id="section-7.3.3-6.3.1">Responder replies with COOKIE-ACK using DTLS CHUNK encrypted with
the Restart DTLS Key Context<a href="#section-7.3.3-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-6.4">
              <p id="section-7.3.3-6.4.1">Initiator and Responder handshake a new DTLS connection<a href="#section-7.3.3-6.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-6.5">
              <p id="section-7.3.3-6.5.1">The ULP can resume communication protected
using the Restart DTLS Key Context.<a href="#section-7.3.3-6.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-6.6">
              <p id="section-7.3.3-6.6.1">New Primary and Restart DTLS Key Context is derived and
installed using Epoch=3. The new Traffic
DTLS Key Context is being used for traffic.
When Primary DTLS Key Context has been installed
the new Restart DTLS Key Context for epoch=3 is installed.<a href="#section-7.3.3-6.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.3.3-7">User Data for any ULP traffic MAY be initiated immediately after
COOKIE-ECHO/COOKIE-ACK handshake using the current Restart DTLS Key Context, that
is even before a new Primary DTLS Key Context or a Restart DTLS Key Context have been
derived.  If a problem occurs before the new Restart DTLS Key Context has been
installed, the Association cannot be Restarted, thus it's RECOMMENDED
the new Restart DTLS Key Context to be installed as early as possible.<a href="#section-7.3.3-7" class="pilcrow">¶</a></p>
<p id="section-7.3.3-8">Note that, different than the initial Association establishment,
the ULP traffic is permitted immediately after the
COOKIE-ECHO/COOKIE-ACK handshake, the reason is that the
validation has already been performed prior to the restart DTLS Key Context was
created.<a href="#section-7.3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="parallel-dtls">
<section id="section-8">
      <h2 id="name-parallel-dtls-rekeying">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-parallel-dtls-rekeying" class="section-name selfRef">Parallel DTLS Rekeying</a>
      </h2>
<p id="section-8-1">Rekeying in this specification is implemented by replacing the DTLS
connection getting old with a new one by first creating the new DTLS
connection, derive the new DTLS Key contexts, start using them,
then closing the old DTLS connection and revoking the old DTLS Key contexts.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="criteria-for-rekeying">
<section id="section-8.1">
        <h3 id="name-criteria-for-rekeying">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-criteria-for-rekeying" class="section-name selfRef">Criteria for Rekeying</a>
        </h3>
<p id="section-8.1-1">The criteria for rekeying may vary depending on the ULP requirement on
security properties, chosen cipher suits etc. Therefore it is assumed
that the implementation will be configurable by the ULP to meet its demand.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Likely criteria to impact the need for rekeying through the usage of
new DTLS connection are:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.1">
            <p id="section-8.1-3.1.1">Time duration since last authentication of the peer<a href="#section-8.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.2">
            <p id="section-8.1-3.2.1">Amount of data transferred since last forward secrecy preserving
rekeying<a href="#section-8.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.3">
            <p id="section-8.1-3.3.1">The cipher suit's maximum key usage being reached.<a href="#section-8.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="procedure-for-rekeying">
<section id="section-8.2">
        <h3 id="name-procedure-for-rekeying">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-procedure-for-rekeying" class="section-name selfRef">Procedure for Rekeying</a>
        </h3>
<p id="section-8.2-1">This specification allows up to 2 DTLS connection to be active at the same
time for the current SCTP Association.
The following state machine applies.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-state-diagram-for-rekeying"></span><div id="dtls-rekeying-state-diagram">
<figure id="figure-8">
          <div id="section-8.2-2.1">
            <div class="alignLeft art-svg artwork" id="section-8.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="592" width="544" viewBox="0 0 544 592" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,560" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 96,144 L 96,176" fill="none" stroke="black"></path>
                <path d="M 96,272 L 96,304" fill="none" stroke="black"></path>
                <path d="M 96,368 L 96,400" fill="none" stroke="black"></path>
                <path d="M 96,480 L 96,512" fill="none" stroke="black"></path>
                <path d="M 136,64 L 136,136" fill="none" stroke="black"></path>
                <path d="M 136,176 L 136,264" fill="none" stroke="black"></path>
                <path d="M 136,304 L 136,360" fill="none" stroke="black"></path>
                <path d="M 136,400 L 136,472" fill="none" stroke="black"></path>
                <path d="M 136,512 L 136,560" fill="none" stroke="black"></path>
                <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
                <path d="M 176,144 L 176,176" fill="none" stroke="black"></path>
                <path d="M 176,272 L 176,304" fill="none" stroke="black"></path>
                <path d="M 176,368 L 176,400" fill="none" stroke="black"></path>
                <path d="M 176,480 L 176,512" fill="none" stroke="black"></path>
                <path d="M 96,32 L 176,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 88,48" fill="none" stroke="black"></path>
                <path d="M 96,64 L 176,64" fill="none" stroke="black"></path>
                <path d="M 96,144 L 176,144" fill="none" stroke="black"></path>
                <path d="M 96,176 L 176,176" fill="none" stroke="black"></path>
                <path d="M 96,272 L 176,272" fill="none" stroke="black"></path>
                <path d="M 96,304 L 176,304" fill="none" stroke="black"></path>
                <path d="M 96,368 L 176,368" fill="none" stroke="black"></path>
                <path d="M 96,400 L 176,400" fill="none" stroke="black"></path>
                <path d="M 96,480 L 176,480" fill="none" stroke="black"></path>
                <path d="M 96,512 L 176,512" fill="none" stroke="black"></path>
                <path d="M 8,560 L 136,560" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="144,472 132,466.4 132,477.6" fill="black" transform="rotate(90,136,472)"></polygon>
                <polygon class="arrowhead" points="144,360 132,354.4 132,365.6" fill="black" transform="rotate(90,136,360)"></polygon>
                <polygon class="arrowhead" points="144,264 132,258.4 132,269.6" fill="black" transform="rotate(90,136,264)"></polygon>
                <polygon class="arrowhead" points="144,136 132,130.4 132,141.6" fill="black" transform="rotate(90,136,136)"></polygon>
                <polygon class="arrowhead" points="96,48 84,42.4 84,53.6" fill="black" transform="rotate(0,88,48)"></polygon>
                <g class="text">
                  <text x="136" y="52">YOUNG</text>
                  <text x="224" y="52">There's</text>
                  <text x="276" y="52">only</text>
                  <text x="312" y="52">one</text>
                  <text x="212" y="68">DTLS</text>
                  <text x="276" y="68">connection</text>
                  <text x="344" y="68">until</text>
                  <text x="216" y="84">aging</text>
                  <text x="276" y="84">criteria</text>
                  <text x="328" y="84">are</text>
                  <text x="360" y="84">met</text>
                  <text x="96" y="116">AGING</text>
                  <text x="180" y="116">REMOTE</text>
                  <text x="232" y="116">AGING</text>
                  <text x="132" y="164">AGED</text>
                  <text x="212" y="164">When</text>
                  <text x="244" y="164">in</text>
                  <text x="276" y="164">AGED</text>
                  <text x="320" y="164">state</text>
                  <text x="352" y="164">a</text>
                  <text x="376" y="164">new</text>
                  <text x="412" y="164">DTLS</text>
                  <text x="476" y="164">connection</text>
                  <text x="532" y="164">is</text>
                  <text x="216" y="180">added</text>
                  <text x="256" y="180">and</text>
                  <text x="308" y="180">deriving</text>
                  <text x="360" y="180">new</text>
                  <text x="408" y="180">Primary</text>
                  <text x="460" y="180">DTLS</text>
                  <text x="496" y="180">Key</text>
                  <text x="224" y="196">Context</text>
                  <text x="268" y="196">as</text>
                  <text x="300" y="196">well</text>
                  <text x="332" y="196">as</text>
                  <text x="352" y="196">a</text>
                  <text x="376" y="196">new</text>
                  <text x="424" y="196">Restart</text>
                  <text x="476" y="196">DTLS</text>
                  <text x="512" y="196">Key</text>
                  <text x="72" y="212">NEW</text>
                  <text x="108" y="212">DTLS</text>
                  <text x="224" y="212">Context</text>
                  <text x="136" y="292">OLD</text>
                  <text x="204" y="292">In</text>
                  <text x="232" y="292">OLD</text>
                  <text x="272" y="292">state</text>
                  <text x="320" y="292">there</text>
                  <text x="360" y="292">are</text>
                  <text x="384" y="292">2</text>
                  <text x="420" y="292">active</text>
                  <text x="468" y="292">DTLS</text>
                  <text x="240" y="308">connections</text>
                  <text x="320" y="308">Traffic</text>
                  <text x="364" y="308">is</text>
                  <text x="412" y="308">switched</text>
                  <text x="460" y="308">to</text>
                  <text x="488" y="308">the</text>
                  <text x="520" y="308">new</text>
                  <text x="224" y="324">Primary</text>
                  <text x="276" y="324">DTLS</text>
                  <text x="312" y="324">Key</text>
                  <text x="360" y="324">Context</text>
                  <text x="84" y="340">SWITCH</text>
                  <text x="136" y="388">DRAIN</text>
                  <text x="208" y="388">The</text>
                  <text x="244" y="388">aged</text>
                  <text x="284" y="388">DTLS</text>
                  <text x="348" y="388">connection</text>
                  <text x="204" y="404">is</text>
                  <text x="248" y="404">drained</text>
                  <text x="308" y="404">before</text>
                  <text x="360" y="404">being</text>
                  <text x="408" y="404">ready</text>
                  <text x="204" y="420">to</text>
                  <text x="228" y="420">be</text>
                  <text x="268" y="420">closed</text>
                  <text x="96" y="452">DRAINED</text>
                  <text x="164" y="452">DTLS</text>
                  <text x="236" y="452">close_notify</text>
                  <text x="132" y="500">DEAD</text>
                  <text x="204" y="500">In</text>
                  <text x="236" y="500">DEAD</text>
                  <text x="280" y="500">state</text>
                  <text x="320" y="500">the</text>
                  <text x="356" y="500">aged</text>
                  <text x="236" y="516">connection</text>
                  <text x="292" y="516">is</text>
                  <text x="332" y="516">closed</text>
                  <text x="88" y="548">REMOVED</text>
                </g>
              </svg><a href="#section-8.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-state-diagram-for-rekeying" class="selfRef">State Diagram for Rekeying</a>
          </figcaption></figure>
</div>
<p id="section-8.2-3">Trigger for rekeying can either be a local AGING event, triggered by
the DTLS connection meeting the criteria for rekeying, or a REMOTE
AGING event, triggered by receiving a DTLS Connection handshake on the
DTLS Connection Index (next value) that would be used for new DTLS
connection.  In such case a new DTLS connection shall be added
according to <a href="#add-dtls-connection" class="auto internal xref">Section 5.2.1</a>.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">As soon as the new DTLS connection completes handshaking, and the
Primary and Restart DTLS Key Contexts have been derived and installed,
the protection of the SCTP packets is moved from the old Primary DTLS
Key Context, then the procedure for closing the old DTLS connection is
initiated, see <a href="#remove-dtls-connection" class="auto internal xref">Section 5.2.2</a>.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="race-condition-in-rekeying">
<section id="section-8.3">
        <h3 id="name-race-condition-in-rekeying">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-race-condition-in-rekeying" class="section-name selfRef">Race Condition in Rekeying</a>
        </h3>
<p id="section-8.3-1">A race condition may happen when both peers experience local AGING event at
the same time and start creation of a new DTLS connection.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">The race condition is solved as specified in <a href="#add-dtls-connection" class="auto internal xref">Section 5.2.1</a>.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="general-1">
<section id="section-9.1">
        <h3 id="name-general-2">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-general-2" class="section-name selfRef">General</a>
        </h3>
<p id="section-9.1-1">The security considerations given in <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, and
<span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> also apply to this document. BCP 195 <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>]</span>
          <span>[<a href="#RFC8996" class="cite xref">RFC8996</a>]</span> provides recommendations and requirements for improving
the security of deployed services that use DTLS. BCP 195 MUST be
followed which implies that DTLS 1.0 SHALL NOT be supported and are
therefore not defined.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-9.2">
        <h3 id="name-privacy-considerations">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-9.2-1">Although DTLS in SCTP provides privacy for the actual user message as
well as almost all chunks, some fields are not confidentiality
protected.  In addition to the DTLS record header, the SCTP common
header and the DTLS chunk header are not confidentiality
protected. An attacker can correlate DTLS connections over the same
SCTP association using the SCTP common header.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">To provide identity protection it is RECOMMENDED that DTLS in SCTP is
used with certificate-based authentication in DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> and
to not reuse tickets.  DTLS 1.3 with external PSK
authentication does not provide identity protection.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">By mandating ephemeral key exchange and cipher suites with
confidentiality DTLS in SCTP effectively mitigate many forms of
passive pervasive monitoring.  By recommending implementations to
frequently set up new DTLS connections with (EC)DHE force attackers to
do dynamic key exfiltration and limits the amount of compromised data
due to key compromise.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-consideration">
<section id="section-10">
      <h2 id="name-iana-consideration">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-consideration" class="section-name selfRef">IANA Consideration</a>
      </h2>
<p id="section-10-1">This document requests the following registration.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="sec-iana-psi">
<section id="section-10.1">
        <h3 id="name-sctp-protection-solution-id">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-sctp-protection-solution-id" class="section-name selfRef">SCTP Protection Solution Identifier</a>
        </h3>
<p id="section-10.1-1">IANA is requested to assign one SCTP Protection Solution Identifier to
identify the key-management defined in this document.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<span id="name-sctp-protection-solution-in"></span><div id="iana-psi">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-sctp-protection-solution-in" class="selfRef">SCTP Protection Solution Indicators</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Identifier</th>
              <th class="text-left" rowspan="1" colspan="1">Solution Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Contact</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">4096</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS in SCTP Handshake</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-TBD</td>
              <td class="text-left" rowspan="1" colspan="1">Draft Authors</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="tls-exporter-labels">
<section id="section-10.2">
        <h3 id="name-tls-exporter-labels">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-tls-exporter-labels" class="section-name selfRef">TLS Exporter Labels</a>
        </h3>
<p id="section-10.2-1">IANA is requested to register the following values in the TLS Exporter
Label Registry <span>[<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> with Reference RFC-TO-BE and empty Comment. The registry was at the time of writing located
at: https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#exporter-labels<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<span id="name-tls-exporter-labels-2"></span><div id="iana-tls-exporter">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-tls-exporter-labels-2" class="selfRef">TLS Exporter Labels</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-OK</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_PRIMARY_CLIENT_KEY</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_PRIMARY_CLIENT_IV</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_PRIMARY_SERVER_KEY</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_PRIMARY_SERVER_IV</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_RESTART_CLIENT_KEY</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_RESTART_CLIENT_IV</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_RESTART_SERVER_KEY</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER_DTLS_IN_SCTP_RESTART_SERVER_IV</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8996">[RFC8996]</dt>
        <dd>
<span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <span class="seriesInfo">DOI 10.17487/RFC8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8996">https://www.rfc-editor.org/info/rfc8996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9260">[RFC9260]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tüxen, M.</span>, and <span class="refAuthor">K. Nielsen</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 9260</span>, <span class="seriesInfo">DOI 10.17487/RFC9260</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9260">https://www.rfc-editor.org/info/rfc9260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9325">[RFC9325]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <span class="seriesInfo">DOI 10.17487/RFC9325</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9325">https://www.rfc-editor.org/info/rfc9325</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-tsvwg-sctp-dtls-chunk">[I-D.draft-ietf-tsvwg-sctp-dtls-chunk]</dt>
        <dd>
<span class="refAuthor">Westerlund, M.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, <span class="refAuthor">Porfiri, C.</span>, and <span class="refAuthor">M. Tüxen</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) DTLS chunk"</span>, <time datetime="2025-07" class="refDate">July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-tsvwg-sctp-dtls-chunk/">https://datatracker.ietf.org/doc/draft-ietf-tsvwg-sctp-dtls-chunk/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3758">[RFC3758]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Ramalho, M.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">P. Conrad</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Partial Reliability Extension"</span>, <span class="seriesInfo">RFC 3758</span>, <span class="seriesInfo">DOI 10.17487/RFC3758</span>, <time datetime="2004-05" class="refDate">May 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3758">https://www.rfc-editor.org/info/rfc3758</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4895">[RFC4895]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 4895</span>, <span class="seriesInfo">DOI 10.17487/RFC4895</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4895">https://www.rfc-editor.org/info/rfc4895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5061">[RFC5061]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Maruyama, S.</span>, and <span class="refAuthor">M. Kozuka</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration"</span>, <span class="seriesInfo">RFC 5061</span>, <span class="seriesInfo">DOI 10.17487/RFC5061</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5061">https://www.rfc-editor.org/info/rfc5061</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6083">[RFC6083]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Seggelmann, R.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6083</span>, <span class="seriesInfo">DOI 10.17487/RFC6083</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6083">https://www.rfc-editor.org/info/rfc6083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9525">[RFC9525]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="seriesInfo">RFC 9525</span>, <span class="seriesInfo">DOI 10.17487/RFC9525</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9525">https://www.rfc-editor.org/info/rfc9525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-rfc8446bis">[I-D.ietf-tls-rfc8446bis]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-rfc8446bis-14</span>, <time datetime="2025-09-13" class="refDate">13 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8446bis-14">https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8446bis-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-uta-rfc6125bis">[I-D.ietf-uta-rfc6125bis]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-rfc6125bis-15</span>, <time datetime="2023-08-10" class="refDate">10 August 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-rfc6125bis-15">https://datatracker.ietf.org/doc/html/draft-ietf-uta-rfc6125bis-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ANSSI-DAT-NT-003">[ANSSI-DAT-NT-003]</dt>
        <dd>
<span class="refAuthor">Agence nationale de la sécurité des systèmes d'information</span>, <span class="refTitle">"Recommendations for securing networks with IPsec"</span>, <span class="seriesInfo">ANSSI Technical Report DAT-NT-003 </span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;">&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KTH-NCSA">[KTH-NCSA]</dt>
      <dd>
<span class="refAuthor">Ekerå, M.</span>, <span class="refTitle">"On factoring integers, and computing discrete logarithms and orders, quantumly"</span>, <span class="seriesInfo">KTH, School of Electrical Engineering and Computer Science (EECS), Computer Science, Theoretical Computer Science, TCS. Swedish NCSA, Swedish Armed Forces. </span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="http://kth.diva-portal.org/smash/get/diva2:1902626/FULLTEXT01.pdf">http://kth.diva-portal.org/smash/get/diva2:1902626/FULLTEXT01.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Magnus Westerlund</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:magnus.westerlund@ericsson.com" class="email">magnus.westerlund@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Claudio Porfiri</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:claudio.porfiri@ericsson.com" class="email">claudio.porfiri@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
